{"version":3,"file":"951.js","mappings":"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","sources":["/dev/workshop/./src/common/BoundNumberField.tsx?","/dev/workshop/./src/paperBox1/common.tsx?","/dev/workshop/./src/common/raymarch.vert?","/dev/workshop/./src/raymarch/OrbitCameraController.ts?","/dev/workshop/./src/common/FPSController.ts?","/dev/workshop/./src/common/useHashState.ts?","/dev/workshop/./src/paperBox1/svg.ts?","/dev/workshop/./src/raymarch/FlyCameraController.ts?","/dev/workshop/./src/paperBox1/PaperSize.tsx?"],"sourcesContent":["import TextField, { } from \"@mui/material/TextField\"\nimport * as React from \"react\"\n\n\nexport function BoundNumberField({\n  state,\n  prop,\n  setStatePartial,\n  ...props\n}\n\n\n\n) {\n  return (\n    React.createElement(TextField, {\n      variant: \"outlined\",\n      size: \"small\",\n      type: \"number\",\n      value: state[prop],\n      onChange: (e) =>\n        setStatePartial({ [prop]: +e.target.value } )\n      ,\n      label: prop,\n      ...props,}\n    )\n  )\n}\n","import * as React from \"react\"\n\nimport { arrayRange, DEG, round10, TAU, V3 } from \"ts3dutils\"\nimport { encode, L, M, Z } from \"./svg\"\n\nexport const INCH = 25.4\nexport const fmtdeg = (x) => \"\" + round10(x / DEG, -1) + \"Â°\"\n \n\nexport const radiusFromSideWidth = (sides, sideWidth) =>\n  sideWidth / 2 / Math.sin(TAU / sides / 2)\nexport const sideWithFromRadius = (sides, radius) =>\n  radius * 2 * Math.sin(TAU / sides / 2)\nexport const centerToSideFromSideWidth = (\n  sides,\n  sideWidth,\n) => sideWidth / 2 / Math.tan(TAU / sides / 2)\nexport const radiusFromCenterToSide = (\n  sides,\n  centerToSide,\n) => centerToSide / Math.cos(TAU / sides / 2)\nexport const sideWidthFromCenterToSide = (\n  sides,\n  centerToSide,\n) => centerToSide * 2 * Math.tan(TAU / sides / 2)\n\nexport function RegularPolygon({\n  sides,\n  radius,\n  startAngle = 0,\n  sideLength = undefined,\n  ...props\n}\n\n\n\n\n) {\n  if ((undefined !== sideLength) === (undefined !== radius)) {\n    throw new Error(\"must set either sideLength or radius\")\n  }\n  if (undefined === radius) {\n    radius = radiusFromSideWidth(sides, sideLength)\n  }\n  return (\n    React.createElement('path', {\n      d: encode(\n        M(V3.polar(radius, startAngle)),\n        ...arrayRange(0, sides).map((i) =>\n          L(V3.polar(radius, startAngle + i * (TAU / sides))),\n        ),\n        Z(),\n      ),\n      ...props,}\n    )\n  )\n}\n\nexport function RotStep({\n  id,\n  children,\n  count,\n  stepDeg,\n}\n\n\n\n\n) {\n  return (\n    React.createElement(React.Fragment, null\n      , React.createElement('g', { id: id,}, children)\n      , arrayRange(0, count - 1).map((i) => (\n        React.createElement('g', {\n          id: `${id}-${i}`,\n          key: `${id}-${i}`,\n          transform: `rotate(${(i + 1) * stepDeg} 0 0)`,}\n\n          , children\n        )\n      ))\n    )\n  )\n}\n\nexport const openInNewTab = (url) => {\n  const newWindow = window.open(url, \"_blank\", \"noopener,noreferrer\")\n  if (newWindow) newWindow.opener = null\n}\n","\nexport default \"#version 300 es\\nprecision highp float;\\n\\nin vec4 ts_Vertex;\\nin vec2 ts_TexCoord;\\nout vec2 coord;\\nvoid main() {\\n  gl_Position = ts_Vertex;\\n  coord = ts_TexCoord;\\n}\\n\"\nconst sourceMap = {\"version\":3,\"sources\":[\"/home/runner/work/workshop/workshop/src/common/raymarch.vert\"],\"names\":[],\"mappings\":\"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA\"}\nexport { sourceMap };\n"," function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }import { clamp, M4, V, V3 } from \"ts3dutils\"\n\n \n\nconst ACTIONS = [\"zoomIn\", \"zoomOut\", \"left\", \"right\", \"up\", \"down\"] \n\n/**\n * You can't use the keyboard events directly to move the camera, as they are\n * not fired often enough. Instead, we track which keys are down and tick()\n * should be called in the render loop.\n *\n * You need to make a DOM element \"focusable\" for the key events to work.\n *\n * Example to use this in a react-controlled component:\n * ```js\n * const [lookAt, setLookAt] = useState(M4.identity)\n * const svgRef = useRef<SVGSVGElement>()\n * useEffect(() => {\n *   const camController = new OrbitCameraController((v) =>\n *     setLookAt(OrbitCameraController.getLookAt(v)),\n *   )\n *   camController.setState([0, 0.1, 200])\n *   camController.registerListeners(svgRef.current)\n *   let cancel = false\n *   function tick() {\n *     camController!.tick()\n *     if (!cancel) requestAnimationFrame(tick)\n *   }\n *   requestAnimationFrame(tick)\n *   return () => {\n *     cancel = true\n *     camController?.unregisterListeners()\n *   }\n * }, [])\n * ```\n */\nexport class OrbitCameraController {\n   __init() {this.lastPos = V3.O}\n  \n\n   __init2() {this.pressedKeys = {\n    zoomIn: false,\n    zoomOut: false,\n    left: false,\n    right: false,\n    up: false,\n    down: false,\n  }}\n   __init3() {this.pauseCam = false}\n   __init4() {this.udRot = 0.1}\n   __init5() {this.rot = 0}\n   __init6() {this.dist = 10}\n\n  constructor(\n      onCameraChange,\n      keys = {\n      zoomIn: \"w\",\n      zoomOut: \"s\",\n      left: \"a\",\n      right: \"d\",\n      up: \" \",\n      down: \"Control\",\n    },\n  ) {;this.onCameraChange = onCameraChange;this.keys = keys;OrbitCameraController.prototype.__init.call(this);OrbitCameraController.prototype.__init2.call(this);OrbitCameraController.prototype.__init3.call(this);OrbitCameraController.prototype.__init4.call(this);OrbitCameraController.prototype.__init5.call(this);OrbitCameraController.prototype.__init6.call(this);OrbitCameraController.prototype.__init7.call(this);OrbitCameraController.prototype.__init8.call(this);OrbitCameraController.prototype.__init9.call(this);OrbitCameraController.prototype.__init10.call(this);OrbitCameraController.prototype.__init11.call(this);OrbitCameraController.prototype.__init12.call(this);}\n\n  __init7() {this.setState = (m) => {\n    ;[this.udRot, this.rot, this.dist] =\n      OrbitCameraController.toOrbitCameraState(m)\n  }}\n\n  static toOrbitCameraState(m) {\n    if (m instanceof M4) {\n      const eye = m\n        .transposed()\n        .scale(-1)\n        .transformVector(m.getTranslation(), false)\n      return [Math.atan(eye.z / eye.lengthXY()), eye.angleXY(), eye.length()]\n    } else {\n      return m\n    }\n  }\n\n  registerListeners(\n    mouseMoveTarget\n\n\n,\n    keyUpDownTarget = mouseMoveTarget,\n  ) {\n    _optionalChain([this, 'access', _5 => _5.unregister, 'optionalCall', _6 => _6()])\n    mouseMoveTarget.addEventListener(\"mousemove\", this.mousemove)\n    mouseMoveTarget.addEventListener(\"wheel\", this.wheel)\n    keyUpDownTarget.addEventListener(\"keydown\", this.keydown)\n    keyUpDownTarget.addEventListener(\"keyup\", this.keyup)\n    keyUpDownTarget.addEventListener(\"blur\", this.keyup)\n\n    return (this.unregister = () => {\n      mouseMoveTarget.removeEventListener(\"mousemove\", this.mousemove)\n      mouseMoveTarget.removeEventListener(\"wheel\", this.wheel)\n      keyUpDownTarget.removeEventListener(\"keydown\", this.keydown)\n      keyUpDownTarget.removeEventListener(\"keyup\", this.keyup)\n      keyUpDownTarget.removeEventListener(\"keyup\", this.keyup)\n    })\n  }\n\n  __init8() {this.blur = () => {\n    // TODO\n  }}\n\n  unregisterListeners() {\n    _optionalChain([this, 'access', _7 => _7.unregister, 'optionalCall', _8 => _8()])\n  }\n\n  tick() {\n    const dDist = (+this.pressedKeys.zoomOut - +this.pressedKeys.zoomIn) * 0.1\n    const dRot = (-+this.pressedKeys.left + +this.pressedKeys.right) * 0.1\n    const newUDRot = clamp(\n      this.udRot + (+this.pressedKeys.up - +this.pressedKeys.down) * 0.1,\n      -Math.PI * 0.5,\n      Math.PI * 0.5,\n    )\n    if (dDist !== 0 || dRot !== 0 || newUDRot !== this.udRot) {\n      this.dist += dDist\n      this.rot += dRot\n      this.udRot = newUDRot\n      _optionalChain([this, 'access', _9 => _9.onCameraChange, 'optionalCall', _10 => _10(this.ss)])\n    }\n  }\n\n   __init9() {this.mousemove = (e) => {\n    const pagePos = V(e.pageX, e.pageY)\n    const delta = this.lastPos.to(pagePos)\n    if (e.buttons & 1 && !this.pauseCam) {\n      // zRot -= delta.x * 0.25 * DEG\n      const dRot = delta.x / 100\n      const newUDRot = clamp(\n        this.udRot + delta.y / 100,\n        -Math.PI * 0.5,\n        Math.PI * 0.5,\n      )\n      if (newUDRot !== this.udRot || dRot !== 0) {\n        this.udRot = newUDRot\n        this.rot += dRot\n        _optionalChain([this, 'access', _11 => _11.onCameraChange, 'optionalCall', _12 => _12(this.ss)])\n        e.stopImmediatePropagation()\n        e.preventDefault()\n      }\n    }\n    this.lastPos = pagePos\n  }}\n\n   __init10() {this.wheel = (e) => {\n    const newDist = clamp(this.dist + e.deltaY, 0.1, 1000)\n    if (newDist !== this.dist) {\n      this.dist = newDist\n      e.stopImmediatePropagation()\n      e.preventDefault()\n      _optionalChain([this, 'access', _13 => _13.onCameraChange, 'optionalCall', _14 => _14(this.ss)])\n    }\n  }}\n\n  get ss() {\n    return [this.udRot, this.rot, this.dist]\n  }\n\n   __init11() {this.keydown = (e) => {\n    for (const action of ACTIONS) {\n      if (this.keys[action] === e.key) {\n        this.pressedKeys[action] = true\n        e.stopImmediatePropagation()\n        e.preventDefault()\n        return\n      }\n    }\n  }}\n\n   __init12() {this.keyup = (e) => {\n    for (const action of ACTIONS) {\n      if (this.keys[action] === e.key) {\n        this.pressedKeys[action] = false\n        e.stopImmediatePropagation()\n        e.preventDefault()\n        return\n      }\n    }\n  }}\n\n  getLookAt() {\n    return OrbitCameraController.getLookAt(this.ss)\n  }\n\n  static getLookAt([udRot, rot, dist]) {\n    return M4.rotateZ(rot)\n      .rotateY(udRot)\n      .transform(M4.lookAt(V(dist, 0, 0), V3.O, V3.Z))\n  }\n\n  static invertLookAt(m) {\n    const inverse = m.transposed().scale(-1)\n    return {\n      eye: inverse.transformVector(m.getTranslation(), false),\n      dir: inverse.transformVector(V3.Z, false),\n      up: inverse.transformVector(V3.Y.negated(), false),\n    }\n  }\n\n  static toShortString(m, posFactor = 100) {\n    const [udRot, rot, dist] = this.toOrbitCameraState(m)\n    const coordString = (v, f) => Math.floor(v * f)\n    return (\n      coordString(udRot, 100) +\n      \"~\" +\n      coordString(rot, 100) +\n      \"~\" +\n      coordString(dist, 100)\n    )\n  }\n\n  static fromShortString(cam, posFactor = 100) {\n    const coord = (s, f) => +s / f\n    const [udRotStr, rotStr, distStr] = cam.split(\"~\")\n    return [coord(udRotStr, 100), coord(rotStr, 100), coord(distStr, 100)]\n  }\n}\n","/**\n * Helper class to count frames per second.\n */\nexport class FPSController {\n   __init() {this.count = 0}\n\n   __init2() {this.lastTime = performance.now()}\n  constructor(\n      notify,\n      window = 10,\n  ) {;this.notify = notify;this.window = window;FPSController.prototype.__init.call(this);FPSController.prototype.__init2.call(this);}\n\n  tick(time = performance.now()) {\n    const window = this.window\n    this.count = (this.count + 1) % window\n    if (this.count === 0) {\n      const fps = Math.floor((window * 1000) / (time - this.lastTime))\n      this.notify(fps)\n      this.lastTime = time\n    }\n  }\n}\n"," function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }import debounce from \"lodash/debounce\"\nimport mapValues from \"lodash/mapValues\"\nimport { useCallback, useEffect, useRef, useState } from \"react\"\nimport {\n  PAPER_SIZE_A4,\n\n  PaperSizeFromString,\n  PaperSizeToString,\n} from \"../paperBox1/PaperSize\"\n\nconst parseHash = (hash) => {\n  return !hash\n    ? {}\n    : hash\n        .substring(1)\n        .split(\"&\")\n        .map((part) => {\n          const [key, value] = part.split(\"=\")\n          return [decodeURIComponent(key), decodeURIComponent(value)]\n        })\n        .reduce(\n          (obj, [key, value]) => {\n            obj[key] = value\n            return obj\n          },\n          {} ,\n        )\n}\nconst objectToHash = (o) => {\n  return (\n    \"#\" +\n    Object.entries(o)\n      .map(\n        ([key, value]) =>\n          encodeURIComponent(key) + \"=\" + encodeURIComponent(value),\n      )\n      .join(\"&\")\n  )\n}\n\nconst defaultDeserialize = (\n  x,\n) =>\n  mapValues(x, (v, key) => {\n    if (\"paperSize\" === key) {\n      try {\n        return PaperSizeFromString(v)\n      } catch (e) {\n        console.error(e)\n        return PAPER_SIZE_A4\n      }\n    } else if (\"true\" === v) {\n      return true\n    } else if (\"false\" === v) {\n      return false\n    } else if (\"NaN\" === v) {\n      return NaN\n    } else if (\"undefined\" === v) {\n      return undefined\n    } else if (\"null\" === v) {\n      return null\n    } else if (\"\" === v) {\n      return \"\"\n    } else if (!isNaN(+v)) {\n      return +v\n    } else {\n      return v\n    }\n  })\nconst defaultSerialize = (x) =>\n  mapValues(x, (v, key) =>\n    key === \"paperSize\" ? PaperSizeToString(v ) : \"\" + v,\n  )\n\nexport function useHashState(\n  initialState,\n  {\n    deserialize = defaultDeserialize,\n    serialize = defaultSerialize,\n    wait = 1000,\n  } = {},\n) {\n  const createInitialState = useCallback(() => {\n    const state =\n      \"function\" === typeof initialState\n        ? (initialState )()\n        : initialState\n    // hash overrides parameter\n    const mergedState = deserialize(\n      Object.assign(serialize(state), parseHash(document.location.hash)),\n    ) \n    console.log(\"replaceState\")\n    history.replaceState(\n      undefined,\n      document.title,\n      objectToHash(serialize(mergedState)),\n    )\n\n    return mergedState\n  }, [deserialize, initialState, serialize])\n  const [state, setState] = useState(createInitialState)\n  const updateHashRef = useRef()\n  useEffect(() => _optionalChain([updateHashRef, 'access', _ => _.current, 'optionalCall', _2 => _2(state)]), [state])\n  if (!updateHashRef.current) {\n    console.log(\"pushState\")\n    updateHashRef.current = debounce(function (newState) {\n      history.pushState(\n        undefined,\n        document.title,\n        objectToHash(serialize(newState)),\n      )\n    }, wait)\n  }\n\n  useEffect(() => {\n    const onHashChange = () => {\n      setState(createInitialState())\n    }\n    window.addEventListener(\"hashchange\", onHashChange)\n    return () => {\n      window.removeEventListener(\"hashchange\", onHashChange)\n    }\n  }, [createInitialState])\n  return [state, setState]\n}\n","import last from \"lodash/last\"\nimport { SVGPathData } from \"svg-pathdata\"\n\n\n\n\n\n\n\n\n\n\nimport { V as VV } from \"ts3dutils\"\n\nexport function H(x) {\n  return { type: SVGPathData.HORIZ_LINE_TO, relative: false, x: x }\n}\n\nexport function A(\n  rx,\n  ry,\n  xAxisRotation,\n  largeArcFlag,\n  sweepFlag,\n  p,\n) {\n  return {\n    lArcFlag: largeArcFlag,\n    rX: rx,\n    rY: ry,\n    relative: false,\n    sweepFlag: sweepFlag,\n    type: SVGPathData.ARC,\n    x: p.x,\n    xRot: 0,\n    y: p.y,\n  }\n}\n\nexport const C = (\n  x1,\n  y1,\n  x2,\n  y2,\n  x,\n  y,\n) => ({\n  type: SVGPathData.CURVE_TO,\n  x1,\n  y1,\n  x2,\n  y2,\n  x,\n  y,\n  relative: false,\n})\n\nexport const V = (y) => ({\n  type: SVGPathData.VERT_LINE_TO,\n  y,\n  relative: false,\n})\n\nexport const S = (x2, y2, x, y) => ({\n  type: SVGPathData.SMOOTH_CURVE_TO,\n  x2,\n  y2,\n  x,\n  y,\n  relative: false,\n})\n\n\n\nexport function M(a1, a2) {\n  const [x, y] = a2 === undefined ? [(a1 ).x, (a1 ).y] : [a1, a2]\n  return { type: SVGPathData.MOVE_TO, x, y, relative: false }\n}\n\nexport const m = (x, y) => ({\n  type: SVGPathData.MOVE_TO,\n  x,\n  y,\n  relative: true,\n})\n\n\n\nexport function L(a1, a2) {\n  const [x, y] = a2 === undefined ? [(a1 ).x, (a1 ).y] : [a1, a2]\n  return { type: SVGPathData.LINE_TO, x, y, relative: false }\n}\n\nexport const l = (x, y) => ({\n  type: SVGPathData.LINE_TO,\n  x,\n  y,\n  relative: true,\n})\n\nexport const Z = () => ({ type: SVGPathData.CLOSE_PATH })\n\nexport const encode = (...path) => {\n  const modPath = []\n  let lastX = 0,\n    lastY = 0\n  for (const c of path) {\n    if (\"function\" === typeof c) {\n      for (const c2 of c(lastX, lastY)) {\n        modPath.push(c2)\n      }\n    } else {\n      modPath.push(c)\n    }\n    const lastC = last(modPath)\n    if (\"x\" in lastC) lastX = lastC.x\n    if (\"y\" in lastC) lastY = lastC.y\n  }\n  return new SVGPathData(modPath).round(3).encode()\n}\n \n\nexport function Corner(rad, x, y) {\n  return (prevX, prevY) => {\n    const prev = VV(prevX, prevY)\n    const p1 = VV(x, y)\n    const dir1 = prev.to(p1).toLength(rad)\n    const p2 = VV(p1.x + dir1.y, p1.y - dir1.x)\n    return [L(p1.minus(dir1)), A(rad, rad, 0, 0, 0, p2)]\n  }\n}\n"," function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }import { DEG, M4, V, V3 } from \"ts3dutils\"\n\n/**\n * You can't use the keyboard events directly to move the camera, as they are\n * not fired often enough. Instead, we track which keys are down and tick()\n * should be called in the render loop.\n */\nexport class FlyCameraController {\n   __init() {this.lastPos = V3.O}\n  \n\n   __init2() {this.pressedKeys = {}}\n   __init3() {this.pauseCam = false}\n\n  constructor(\n     state,\n      onChange,\n      lockUp,\n  ) {;this.state = state;this.onChange = onChange;this.lockUp = lockUp;FlyCameraController.prototype.__init.call(this);FlyCameraController.prototype.__init2.call(this);FlyCameraController.prototype.__init3.call(this);FlyCameraController.prototype.__init4.call(this);FlyCameraController.prototype.__init5.call(this);FlyCameraController.prototype.__init6.call(this);FlyCameraController.prototype.__init7.call(this);}\n\n  __init4() {this.setState = (m) => {\n    m !== this.state && M4.copy(m, this.state)\n  }}\n\n  registerListeners(\n    mouseMoveTarget\n\n\n,\n    keyUpDownTarget = mouseMoveTarget,\n  ) {\n    _optionalChain([this, 'access', _3 => _3.unregister, 'optionalCall', _4 => _4()])\n    mouseMoveTarget.addEventListener(\"mousemove\", this.mousemove)\n    keyUpDownTarget.addEventListener(\"keydown\", this.keydown)\n    keyUpDownTarget.addEventListener(\"keyup\", this.keyup)\n\n    return (this.unregister = () => {\n      mouseMoveTarget.removeEventListener(\"mousemove\", this.mousemove)\n      keyUpDownTarget.removeEventListener(\"keydown\", this.keydown)\n      keyUpDownTarget.removeEventListener(\"keyup\", this.keyup)\n    })\n  }\n\n  unregisterListeners() {\n    _optionalChain([this, 'access', _5 => _5.unregister, 'optionalCall', _6 => _6()])\n  }\n\n  tick() {\n    const speed = new V3(\n      +!!this.pressedKeys.a - +!!this.pressedKeys.d,\n      +!!this.pressedKeys.q +\n        +!!this.pressedKeys.Control -\n        +!!this.pressedKeys.e -\n        +!!this.pressedKeys[\" \"],\n      +!!this.pressedKeys.w - +!!this.pressedKeys.s,\n    )\n    if (!speed.likeO()) {\n      this.state = this.state.translate(speed.toLength(0.05))\n      _optionalChain([this, 'access', _7 => _7.onChange, 'optionalCall', _8 => _8(this.state)])\n    }\n  }\n\n   __init5() {this.mousemove = (e) => {\n    const pagePos = V(e.pageX, e.pageY)\n    const delta = this.lastPos.to(pagePos)\n    if (e.buttons & 1 && !this.pauseCam) {\n      // zRot -= delta.x * 0.25 * DEG\n      const rot = M4.rotateY(delta.x * 0.25 * DEG)\n        //\n        .rotateX(delta.y * 0.25 * DEG)\n      this.state = rot.times(this.state)\n      // rot = rot.rotate(V3.O, rot.X, delta.y * 0.25 * DEG)\n      // yRot = clamp(yRot - delta.y * 0.25 * DEG, -85 * DEG, 85 * DEG)\n      _optionalChain([this, 'access', _9 => _9.onChange, 'optionalCall', _10 => _10(this.state)])\n    }\n    this.lastPos = pagePos\n  }}\n\n   __init6() {this.keydown = (e) => {\n    this.pressedKeys[e.key] = true\n    e.preventDefault()\n  }}\n   __init7() {this.keyup = (e) => {\n    this.pressedKeys[e.key] = undefined\n    e.preventDefault()\n  }}\n\n  getLookAt() {\n    return this.state\n  }\n\n  static invertLookAt(m) {\n    const inverse = m.transposed().scale(-1)\n    return {\n      eye: inverse.transformVector(m.getTranslation(), false),\n      dir: inverse.transformVector(V3.Z, false),\n      up: inverse.transformVector(V3.Y.negated(), false),\n    }\n  }\n\n  static toShortString(lookAt, posFactor = 100) {\n    const coordString = (v, f) =>\n      [v.x, v.y, v.z].map((e) => Math.floor(e * f)).join(\".\")\n    const { eye, dir, up } = FlyCameraController.invertLookAt(lookAt)\n    return (\n      coordString(eye, posFactor) +\n      \"~\" +\n      coordString(dir.unit(), 100) +\n      \"~\" +\n      coordString(up, 100)\n    )\n  }\n\n  static fromShortString(cam, posFactor = 100) {\n    const coord = (s, f) =>\n      V(s.split(\".\").map((sp) => +sp / f) )\n    const [posStr, lookDirStr, upStr] = cam.split(\"~\")\n    const eye = coord(posStr, posFactor)\n    return M4.lookAt(eye, eye.plus(coord(lookDirStr, 100)), coord(upStr, 100))\n  }\n}\n"," function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } }import { MINUS } from \"ts3dutils\"\n\n \n// Always portrait orientation,\n\n// Always portrait orientation,\nexport const PAPER_SIZES_A = [\n  [841, 1189, \"A0\"],\n  [594, 841, \"A1\"],\n  [420, 594, \"A2\"],\n  [297, 420, \"A3\"],\n  [210, 297, \"A4\"],\n  [148, 210, \"A5\"],\n  [105, 148, \"A6\"],\n  [74, 105, \"A7\"],\n  [52, 74, \"A8\"],\n  [37, 52, \"A9\"],\n  [26, 37, \"A10\"],\n]\n\nexport function PaperSizeEquals([aw, ah], [bw, bh]) {\n  return aw === bw && bh === bw\n}\n\nexport const PAPER_SIZES_B = [\n  [1000, 1414, \"C0\"],\n  [707, 1000, \"C1\"],\n  [500, 707, \"C2\"],\n  [353, 500, \"C3\"],\n  [250, 353, \"C4\"],\n  [176, 250, \"C5\"],\n  [125, 176, \"C6\"],\n  [88, 125, \"C7\"],\n  [62, 88, \"C8\"],\n  [44, 62, \"C9\"],\n  [31, 44, \"C10\"],\n]\n\n// C size envelopes fit A size paper.\nexport const PAPER_SIZES_C = [\n  [917, 1297, \"C0\"],\n  [648, 917, \"C1\"],\n  [458, 648, \"C2\"],\n  [324, 458, \"C3\"],\n  [229, 324, \"C4\"],\n  [162, 229, \"C5\"],\n  [114, 162, \"C6\"],\n  [81, 114, \"C7\"],\n  [57, 81, \"C8\"],\n  [40, 57, \"C9\"],\n  [28, 40, \"C10\"],\n]\nexport const PAPER_SIZES = [\n  ...PAPER_SIZES_A,\n  [150, 150, \"Origami 15cm\"],\n  [100, 100, \"Origami 10cm\"],\n  [75, 75, \"Origami 7.5cm\"],\n  [215.9, 279.4, \"Letter\"],\n  [215.9, 355.6, \"Legal\"],\n  [205, 292, \"Cricut A4\"],\n]\n\nexport const ALL_PAPER_SIZES = [\n  ...PAPER_SIZES,\n  ...PAPER_SIZES_C,\n  ...PAPER_SIZES_B,\n]\n\nexport function PaperSizeFromString(str) {\n  const byName = PAPER_SIZES.find(([, , name]) => name === str)\n  if (byName) return byName\n  const [a, b] = str.split(\"x\")\n  return [+a, +b, \"Custom\"]\n}\nexport function PaperSizeFromDimensions(a, b) {\n  ;[a, b] = [a, b].sort(MINUS)\n  return _nullishCoalesce(PAPER_SIZES.find(([x, y]) => x === a && y === b), () => ( [a, b, \"Custom\"]))\n}\nexport function PaperSizeToString([a, b, name]) {\n  return name === \"Custom\" ? \"\" + a + \"x\" + b : name\n}\n\nexport const PAPER_SIZE_A4 = PAPER_SIZES_A[4]\n"],"names":["BoundNumberField","state","prop","setStatePartial","props","variant","size","type","value","onChange","e","target","label","INCH","fmtdeg","x","radiusFromSideWidth","sides","sideWidth","Math","sin","sideWithFromRadius","radius","centerToSideFromSideWidth","tan","radiusFromCenterToSide","centerToSide","cos","sideWidthFromCenterToSide","RegularPolygon","startAngle","sideLength","undefined","Error","d","M","V3","polar","map","i","L","Z","RotStep","id","children","count","stepDeg","key","transform","openInNewTab","url","newWindow","window","open","opener","_optionalChain","ops","lastAccessLHS","length","op","fn","args","call","ACTIONS","OrbitCameraController","__init","this","lastPos","O","__init2","pressedKeys","zoomIn","zoomOut","left","right","up","down","__init3","pauseCam","__init4","udRot","__init5","rot","__init6","dist","constructor","onCameraChange","keys","prototype","__init7","__init8","__init9","__init10","__init11","__init12","setState","m","toOrbitCameraState","M4","eye","transposed","scale","transformVector","getTranslation","atan","z","lengthXY","angleXY","registerListeners","mouseMoveTarget","keyUpDownTarget","_5","unregister","_6","addEventListener","mousemove","wheel","keydown","keyup","removeEventListener","blur","unregisterListeners","_7","_8","tick","dDist","dRot","newUDRot","PI","_9","_10","ss","pagePos","V","pageX","pageY","delta","to","buttons","y","_11","_12","stopImmediatePropagation","preventDefault","newDist","deltaY","_13","_14","action","getLookAt","rotateZ","rotateY","lookAt","invertLookAt","inverse","dir","Y","negated","toShortString","posFactor","coordString","v","f","floor","fromShortString","cam","coord","s","udRotStr","rotStr","distStr","split","FPSController","lastTime","performance","now","notify","time","fps","parseHash","hash","substring","part","decodeURIComponent","reduce","obj","objectToHash","o","Object","entries","encodeURIComponent","join","defaultDeserialize","NaN","isNaN","console","error","defaultSerialize","useHashState","initialState","deserialize","serialize","wait","createInitialState","useCallback","mergedState","assign","document","location","log","history","replaceState","title","useState","updateHashRef","useRef","useEffect","_","current","_2","newState","pushState","onHashChange","H","HORIZ_LINE_TO","relative","A","rx","ry","xAxisRotation","largeArcFlag","sweepFlag","p","lArcFlag","rX","rY","ARC","xRot","C","x1","y1","x2","y2","CURVE_TO","VERT_LINE_TO","a1","a2","MOVE_TO","LINE_TO","l","CLOSE_PATH","encode","path","modPath","lastX","lastY","c","c2","push","lastC","round","Corner","rad","prevX","prevY","prev","p1","dir1","toLength","p2","minus","FlyCameraController","lockUp","copy","_3","_4","speed","a","q","Control","w","likeO","translate","rotateX","times","unit","sp","posStr","lookDirStr","upStr","plus","PAPER_SIZES_A","PAPER_SIZES_C","PAPER_SIZES","PaperSizeFromString","str","byName","find","name","b","PaperSizeFromDimensions","sort","lhs","rhsFn","PaperSizeToString","PAPER_SIZE_A4"],"sourceRoot":""}