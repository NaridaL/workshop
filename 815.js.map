{"version":3,"file":"815.js","mappings":"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","sources":["/dev/workshop/./src/common/BoundNumberField.tsx?","/dev/workshop/./src/common/FPSController.ts?","/dev/workshop/./src/common/useHashState.ts?","/dev/workshop/./src/paperBox1/PaperSize.tsx?","/dev/workshop/./src/paperBox1/common.tsx?","/dev/workshop/./src/paperBox1/svg.ts?","/dev/workshop/./src/raymarch/FlyCameraController.ts?","/dev/workshop/./src/raymarch/OrbitCameraController.ts?","/dev/workshop/./src/common/raymarch.vert?"],"sourcesContent":["import TextField, { } from \"@mui/material/TextField\"\nimport * as React from \"react\"\n\n\nexport function BoundNumberField({\n  state,\n  prop,\n  setStatePartial,\n  ...props\n}\n\n\n\n) {\n  return (\n    React.createElement(TextField, {\n      variant: \"outlined\",\n      size: \"small\",\n      type: \"number\",\n      value: state[prop],\n      onChange: (e) =>\n        setStatePartial({ [prop]: +e.target.value } )\n      ,\n      label: prop,\n      ...props,}\n    )\n  )\n}\n","/**\n * Helper class to count frames per second.\n */\nexport class FPSController {\n   __init() {this.count = 0}\n\n   __init2() {this.lastTime = performance.now()}\n  constructor(\n      notify,\n      window = 10,\n  ) {;this.notify = notify;this.window = window;FPSController.prototype.__init.call(this);FPSController.prototype.__init2.call(this);}\n\n  tick(time = performance.now()) {\n    const window = this.window\n    this.count = (this.count + 1) % window\n    if (this.count === 0) {\n      const fps = Math.floor((window * 1000) / (time - this.lastTime))\n      this.notify(fps)\n      this.lastTime = time\n    }\n  }\n}\n"," function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }import debounce from \"lodash/debounce\"\nimport mapValues from \"lodash/mapValues\"\nimport { useCallback, useEffect, useRef, useState } from \"react\"\nimport {\n  PAPER_SIZE_A4,\n\n  PaperSizeFromString,\n  PaperSizeToString,\n} from \"../paperBox1/PaperSize\"\n\nconst parseHash = (hash) => {\n  return !hash\n    ? {}\n    : hash\n        .substring(1)\n        .split(\"&\")\n        .map((part) => {\n          const [key, value] = part.split(\"=\")\n          return [decodeURIComponent(key), decodeURIComponent(value)]\n        })\n        .reduce(\n          (obj, [key, value]) => {\n            obj[key] = value\n            return obj\n          },\n          {} ,\n        )\n}\nconst objectToHash = (o) => {\n  return (\n    \"#\" +\n    Object.entries(o)\n      .map(\n        ([key, value]) =>\n          encodeURIComponent(key) + \"=\" + encodeURIComponent(value),\n      )\n      .join(\"&\")\n  )\n}\n\nconst defaultDeserialize = (\n  x,\n) =>\n  mapValues(x, (v, key) => {\n    if (\"paperSize\" === key) {\n      try {\n        return PaperSizeFromString(v)\n      } catch (e) {\n        console.error(e)\n        return PAPER_SIZE_A4\n      }\n    } else if (\"true\" === v) {\n      return true\n    } else if (\"false\" === v) {\n      return false\n    } else if (\"NaN\" === v) {\n      return NaN\n    } else if (\"undefined\" === v) {\n      return undefined\n    } else if (\"null\" === v) {\n      return null\n    } else if (\"\" === v) {\n      return \"\"\n    } else if (!isNaN(+v)) {\n      return +v\n    } else {\n      return v\n    }\n  })\nconst defaultSerialize = (x) =>\n  mapValues(x, (v, key) =>\n    key === \"paperSize\" ? PaperSizeToString(v ) : \"\" + v,\n  )\n\nexport function useHashState(\n  initialState,\n  {\n    deserialize = defaultDeserialize,\n    serialize = defaultSerialize,\n    wait = 1000,\n  } = {},\n) {\n  const createInitialState = useCallback(() => {\n    const state =\n      \"function\" === typeof initialState\n        ? (initialState )()\n        : initialState\n    // hash overrides parameter\n    const mergedState = deserialize(\n      Object.assign(serialize(state), parseHash(document.location.hash)),\n    ) \n    console.log(\"replaceState\")\n    history.replaceState(\n      undefined,\n      document.title,\n      objectToHash(serialize(mergedState)),\n    )\n\n    return mergedState\n  }, [deserialize, initialState, serialize])\n  const [state, setState] = useState(createInitialState)\n  const updateHashRef = useRef()\n  useEffect(() => _optionalChain([updateHashRef, 'access', _ => _.current, 'optionalCall', _2 => _2(state)]), [state])\n  if (!updateHashRef.current) {\n    console.log(\"pushState\")\n    updateHashRef.current = debounce(function (newState) {\n      history.pushState(\n        undefined,\n        document.title,\n        objectToHash(serialize(newState)),\n      )\n    }, wait)\n  }\n\n  useEffect(() => {\n    const onHashChange = () => {\n      setState(createInitialState())\n    }\n    window.addEventListener(\"hashchange\", onHashChange)\n    return () => {\n      window.removeEventListener(\"hashchange\", onHashChange)\n    }\n  }, [createInitialState])\n  return [state, setState]\n}\n"," function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } }import { MINUS } from \"ts3dutils\"\n\n \n// Always portrait orientation,\n\n// Always portrait orientation,\nexport const PAPER_SIZES_A = [\n  [841, 1189, \"A0\"],\n  [594, 841, \"A1\"],\n  [420, 594, \"A2\"],\n  [297, 420, \"A3\"],\n  [210, 297, \"A4\"],\n  [148, 210, \"A5\"],\n  [105, 148, \"A6\"],\n  [74, 105, \"A7\"],\n  [52, 74, \"A8\"],\n  [37, 52, \"A9\"],\n  [26, 37, \"A10\"],\n]\n\nexport function PaperSizeEquals([aw, ah], [bw, bh]) {\n  return aw === bw && bh === bw\n}\n\nexport const PAPER_SIZES_B = [\n  [1000, 1414, \"C0\"],\n  [707, 1000, \"C1\"],\n  [500, 707, \"C2\"],\n  [353, 500, \"C3\"],\n  [250, 353, \"C4\"],\n  [176, 250, \"C5\"],\n  [125, 176, \"C6\"],\n  [88, 125, \"C7\"],\n  [62, 88, \"C8\"],\n  [44, 62, \"C9\"],\n  [31, 44, \"C10\"],\n]\n\n// C size envelopes fit A size paper.\nexport const PAPER_SIZES_C = [\n  [917, 1297, \"C0\"],\n  [648, 917, \"C1\"],\n  [458, 648, \"C2\"],\n  [324, 458, \"C3\"],\n  [229, 324, \"C4\"],\n  [162, 229, \"C5\"],\n  [114, 162, \"C6\"],\n  [81, 114, \"C7\"],\n  [57, 81, \"C8\"],\n  [40, 57, \"C9\"],\n  [28, 40, \"C10\"],\n]\nexport const PAPER_SIZES = [\n  ...PAPER_SIZES_A,\n  [150, 150, \"Origami 15cm\"],\n  [100, 100, \"Origami 10cm\"],\n  [75, 75, \"Origami 7.5cm\"],\n  [215.9, 279.4, \"Letter\"],\n  [215.9, 355.6, \"Legal\"],\n]\n\nexport const ALL_PAPER_SIZES = [\n  ...PAPER_SIZES,\n  ...PAPER_SIZES_C,\n  ...PAPER_SIZES_B,\n]\n\nexport function PaperSizeFromString(str) {\n  const byName = PAPER_SIZES.find(([, , name]) => name === str)\n  if (byName) return byName\n  const [a, b] = str.split(\"x\")\n  return [+a, +b, \"Custom\"]\n}\nexport function PaperSizeFromDimensions(a, b) {\n  ;[a, b] = [a, b].sort(MINUS)\n  return _nullishCoalesce(PAPER_SIZES.find(([x, y]) => x === a && y === b), () => ( [a, b, \"Custom\"]))\n}\nexport function PaperSizeToString([a, b, name]) {\n  return name === \"Custom\" ? \"\" + a + \"x\" + b : name\n}\n\nexport const PAPER_SIZE_A4 = PAPER_SIZES_A[4]\n","import * as React from \"react\"\n\nimport { arrayRange, DEG, round10, TAU, V3 } from \"ts3dutils\"\nimport { encode, L, M, Z } from \"./svg\"\n\nexport const INCH = 25.4\nexport const fmtdeg = (x) => \"\" + round10(x / DEG, -1) + \"Â°\"\n \n\nexport const radiusFromSideWidth = (sides, sideWidth) =>\n  sideWidth / 2 / Math.sin(TAU / sides / 2)\nexport const sideWithFromRadius = (sides, radius) =>\n  radius * 2 * Math.sin(TAU / sides / 2)\nexport const centerToSideFromSideWidth = (\n  sides,\n  sideWidth,\n) => sideWidth / 2 / Math.tan(TAU / sides / 2)\nexport const radiusFromCenterToSide = (\n  sides,\n  centerToSide,\n) => centerToSide / Math.cos(TAU / sides / 2)\nexport const sideWidthFromCenterToSide = (\n  sides,\n  centerToSide,\n) => centerToSide * 2 * Math.tan(TAU / sides / 2)\n\nexport function RegularPolygon({\n  sides,\n  radius,\n  startAngle = 0,\n  sideLength = undefined,\n  ...props\n}\n\n\n\n\n) {\n  if ((undefined !== sideLength) === (undefined !== radius)) {\n    throw new Error(\"must set either sideLength or radius\")\n  }\n  if (undefined === radius) {\n    radius = radiusFromSideWidth(sides, sideLength)\n  }\n  return (\n    React.createElement('path', {\n      d: encode(\n        M(V3.polar(radius, startAngle)),\n        ...arrayRange(0, sides).map((i) =>\n          L(V3.polar(radius, startAngle + i * (TAU / sides))),\n        ),\n        Z(),\n      ),\n      ...props,}\n    )\n  )\n}\n\nexport function RotStep({\n  id,\n  children,\n  count,\n  stepDeg,\n}\n\n\n\n\n) {\n  return (\n    React.createElement(React.Fragment, null\n      , React.createElement('g', { id: id,}, children)\n      , arrayRange(0, count - 1).map((i) => (\n        React.createElement('g', {\n          id: `${id}-${i}`,\n          key: `${id}-${i}`,\n          transform: `rotate(${(i + 1) * stepDeg} 0 0)`,}\n\n          , children\n        )\n      ))\n    )\n  )\n}\n\nexport const openInNewTab = (url) => {\n  const newWindow = window.open(url, \"_blank\", \"noopener,noreferrer\")\n  if (newWindow) newWindow.opener = null\n}\n","import last from \"lodash/last\"\nimport { SVGPathData } from \"svg-pathdata\"\n\n\n\n\n\n\n\n\n\n\nimport { V as VV } from \"ts3dutils\"\n\nexport function H(x) {\n  return { type: SVGPathData.HORIZ_LINE_TO, relative: false, x: x }\n}\n\nexport function A(\n  rx,\n  ry,\n  xAxisRotation,\n  largeArcFlag,\n  sweepFlag,\n  p,\n) {\n  return {\n    lArcFlag: largeArcFlag,\n    rX: rx,\n    rY: ry,\n    relative: false,\n    sweepFlag: sweepFlag,\n    type: SVGPathData.ARC,\n    x: p.x,\n    xRot: 0,\n    y: p.y,\n  }\n}\n\nexport const C = (\n  x1,\n  y1,\n  x2,\n  y2,\n  x,\n  y,\n) => ({\n  type: SVGPathData.CURVE_TO,\n  x1,\n  y1,\n  x2,\n  y2,\n  x,\n  y,\n  relative: false,\n})\n\nexport const V = (y) => ({\n  type: SVGPathData.VERT_LINE_TO,\n  y,\n  relative: false,\n})\n\nexport const S = (x2, y2, x, y) => ({\n  type: SVGPathData.SMOOTH_CURVE_TO,\n  x2,\n  y2,\n  x,\n  y,\n  relative: false,\n})\n\n\n\nexport function M(a1, a2) {\n  const [x, y] = a2 === undefined ? [(a1 ).x, (a1 ).y] : [a1, a2]\n  return { type: SVGPathData.MOVE_TO, x, y, relative: false }\n}\n\nexport const m = (x, y) => ({\n  type: SVGPathData.MOVE_TO,\n  x,\n  y,\n  relative: true,\n})\n\n\n\nexport function L(a1, a2) {\n  const [x, y] = a2 === undefined ? [(a1 ).x, (a1 ).y] : [a1, a2]\n  return { type: SVGPathData.LINE_TO, x, y, relative: false }\n}\n\nexport const l = (x, y) => ({\n  type: SVGPathData.LINE_TO,\n  x,\n  y,\n  relative: true,\n})\n\nexport const Z = () => ({ type: SVGPathData.CLOSE_PATH })\n\nexport const encode = (...path) => {\n  const modPath = []\n  let lastX = 0,\n    lastY = 0\n  for (const c of path) {\n    if (\"function\" === typeof c) {\n      for (const c2 of c(lastX, lastY)) {\n        modPath.push(c2)\n      }\n    } else {\n      modPath.push(c)\n    }\n    const lastC = last(modPath)\n    if (\"x\" in lastC) lastX = lastC.x\n    if (\"y\" in lastC) lastY = lastC.y\n  }\n  return new SVGPathData(modPath).round(3).encode()\n}\n \n\nexport function Corner(rad, x, y) {\n  return (prevX, prevY) => {\n    const prev = VV(prevX, prevY)\n    const p1 = VV(x, y)\n    const dir1 = prev.to(p1).toLength(rad)\n    const p2 = VV(p1.x + dir1.y, p1.y - dir1.x)\n    return [L(p1.minus(dir1)), A(rad, rad, 0, 0, 0, p2)]\n  }\n}\n"," function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }import { DEG, M4, V, V3 } from \"ts3dutils\"\n\n/**\n * You can't use the keyboard events directly to move the camera, as they are\n * not fired often enough. Instead, we track which keys are down and tick()\n * should be called in the render loop.\n */\nexport class FlyCameraController {\n   __init() {this.lastPos = V3.O}\n  \n\n   __init2() {this.pressedKeys = {}}\n   __init3() {this.pauseCam = false}\n\n  constructor(\n     state,\n      onChange,\n      lockUp,\n  ) {;this.state = state;this.onChange = onChange;this.lockUp = lockUp;FlyCameraController.prototype.__init.call(this);FlyCameraController.prototype.__init2.call(this);FlyCameraController.prototype.__init3.call(this);FlyCameraController.prototype.__init4.call(this);FlyCameraController.prototype.__init5.call(this);FlyCameraController.prototype.__init6.call(this);FlyCameraController.prototype.__init7.call(this);}\n\n  __init4() {this.setState = (m) => {\n    m !== this.state && M4.copy(m, this.state)\n  }}\n\n  registerListeners(\n    mouseMoveTarget\n\n\n,\n    keyUpDownTarget = mouseMoveTarget,\n  ) {\n    _optionalChain([this, 'access', _3 => _3.unregister, 'optionalCall', _4 => _4()])\n    mouseMoveTarget.addEventListener(\"mousemove\", this.mousemove)\n    keyUpDownTarget.addEventListener(\"keydown\", this.keydown)\n    keyUpDownTarget.addEventListener(\"keyup\", this.keyup)\n\n    return (this.unregister = () => {\n      mouseMoveTarget.removeEventListener(\"mousemove\", this.mousemove)\n      keyUpDownTarget.removeEventListener(\"keydown\", this.keydown)\n      keyUpDownTarget.removeEventListener(\"keyup\", this.keyup)\n    })\n  }\n\n  unregisterListeners() {\n    _optionalChain([this, 'access', _5 => _5.unregister, 'optionalCall', _6 => _6()])\n  }\n\n  tick() {\n    const speed = new V3(\n      +!!this.pressedKeys.a - +!!this.pressedKeys.d,\n      +!!this.pressedKeys.q +\n        +!!this.pressedKeys.Control -\n        +!!this.pressedKeys.e -\n        +!!this.pressedKeys[\" \"],\n      +!!this.pressedKeys.w - +!!this.pressedKeys.s,\n    )\n    if (!speed.likeO()) {\n      this.state = this.state.translate(speed.toLength(0.05))\n      _optionalChain([this, 'access', _7 => _7.onChange, 'optionalCall', _8 => _8(this.state)])\n    }\n  }\n\n   __init5() {this.mousemove = (e) => {\n    const pagePos = V(e.pageX, e.pageY)\n    const delta = this.lastPos.to(pagePos)\n    if (e.buttons & 1 && !this.pauseCam) {\n      // zRot -= delta.x * 0.25 * DEG\n      const rot = M4.rotateY(delta.x * 0.25 * DEG)\n        //\n        .rotateX(delta.y * 0.25 * DEG)\n      this.state = rot.times(this.state)\n      // rot = rot.rotate(V3.O, rot.X, delta.y * 0.25 * DEG)\n      // yRot = clamp(yRot - delta.y * 0.25 * DEG, -85 * DEG, 85 * DEG)\n      _optionalChain([this, 'access', _9 => _9.onChange, 'optionalCall', _10 => _10(this.state)])\n    }\n    this.lastPos = pagePos\n  }}\n\n   __init6() {this.keydown = (e) => {\n    this.pressedKeys[e.key] = true\n    e.preventDefault()\n  }}\n   __init7() {this.keyup = (e) => {\n    this.pressedKeys[e.key] = undefined\n    e.preventDefault()\n  }}\n\n  getLookAt() {\n    return this.state\n  }\n\n  static invertLookAt(m) {\n    const inverse = m.transposed().scale(-1)\n    return {\n      eye: inverse.transformVector(m.getTranslation(), false),\n      dir: inverse.transformVector(V3.Z, false),\n      up: inverse.transformVector(V3.Y.negated(), false),\n    }\n  }\n\n  static toShortString(lookAt, posFactor = 100) {\n    const coordString = (v, f) =>\n      [v.x, v.y, v.z].map((e) => Math.floor(e * f)).join(\".\")\n    const { eye, dir, up } = FlyCameraController.invertLookAt(lookAt)\n    return (\n      coordString(eye, posFactor) +\n      \"~\" +\n      coordString(dir.unit(), 100) +\n      \"~\" +\n      coordString(up, 100)\n    )\n  }\n\n  static fromShortString(cam, posFactor = 100) {\n    const coord = (s, f) =>\n      V(s.split(\".\").map((sp) => +sp / f) )\n    const [posStr, lookDirStr, upStr] = cam.split(\"~\")\n    const eye = coord(posStr, posFactor)\n    return M4.lookAt(eye, eye.plus(coord(lookDirStr, 100)), coord(upStr, 100))\n  }\n}\n"," function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }import { clamp, M4, V, V3 } from \"ts3dutils\"\n\n \n\nconst ACTIONS = [\"zoomIn\", \"zoomOut\", \"left\", \"right\", \"up\", \"down\"] \n\n/**\n * You can't use the keyboard events directly to move the camera, as they are\n * not fired often enough. Instead, we track which keys are down and tick()\n * should be called in the render loop.\n *\n * You need to make a DOM element \"focusable\" for the key events to work.\n *\n * Example to use this in a react-controlled component:\n * ```js\n * const [lookAt, setLookAt] = useState(M4.identity)\n * const svgRef = useRef<SVGSVGElement>()\n * useEffect(() => {\n *   const camController = new OrbitCameraController((v) =>\n *     setLookAt(OrbitCameraController.getLookAt(v)),\n *   )\n *   camController.setState([0, 0.1, 200])\n *   camController.registerListeners(svgRef.current)\n *   let cancel = false\n *   function tick() {\n *     camController!.tick()\n *     if (!cancel) requestAnimationFrame(tick)\n *   }\n *   requestAnimationFrame(tick)\n *   return () => {\n *     cancel = true\n *     camController?.unregisterListeners()\n *   }\n * }, [])\n * ```\n */\nexport class OrbitCameraController {\n   __init() {this.lastPos = V3.O}\n  \n\n   __init2() {this.pressedKeys = {\n    zoomIn: false,\n    zoomOut: false,\n    left: false,\n    right: false,\n    up: false,\n    down: false,\n  }}\n   __init3() {this.pauseCam = false}\n   __init4() {this.udRot = 0.1}\n   __init5() {this.rot = 0}\n   __init6() {this.dist = 10}\n\n  constructor(\n      onCameraChange,\n      keys = {\n      zoomIn: \"w\",\n      zoomOut: \"s\",\n      left: \"a\",\n      right: \"d\",\n      up: \" \",\n      down: \"Control\",\n    },\n  ) {;this.onCameraChange = onCameraChange;this.keys = keys;OrbitCameraController.prototype.__init.call(this);OrbitCameraController.prototype.__init2.call(this);OrbitCameraController.prototype.__init3.call(this);OrbitCameraController.prototype.__init4.call(this);OrbitCameraController.prototype.__init5.call(this);OrbitCameraController.prototype.__init6.call(this);OrbitCameraController.prototype.__init7.call(this);OrbitCameraController.prototype.__init8.call(this);OrbitCameraController.prototype.__init9.call(this);OrbitCameraController.prototype.__init10.call(this);OrbitCameraController.prototype.__init11.call(this);OrbitCameraController.prototype.__init12.call(this);}\n\n  __init7() {this.setState = (m) => {\n    ;[this.udRot, this.rot, this.dist] =\n      OrbitCameraController.toOrbitCameraState(m)\n  }}\n\n  static toOrbitCameraState(m) {\n    if (m instanceof M4) {\n      const eye = m\n        .transposed()\n        .scale(-1)\n        .transformVector(m.getTranslation(), false)\n      return [Math.atan(eye.z / eye.lengthXY()), eye.angleXY(), eye.length()]\n    } else {\n      return m\n    }\n  }\n\n  registerListeners(\n    mouseMoveTarget\n\n\n,\n    keyUpDownTarget = mouseMoveTarget,\n  ) {\n    _optionalChain([this, 'access', _5 => _5.unregister, 'optionalCall', _6 => _6()])\n    mouseMoveTarget.addEventListener(\"mousemove\", this.mousemove)\n    mouseMoveTarget.addEventListener(\"wheel\", this.wheel)\n    keyUpDownTarget.addEventListener(\"keydown\", this.keydown)\n    keyUpDownTarget.addEventListener(\"keyup\", this.keyup)\n    keyUpDownTarget.addEventListener(\"blur\", this.keyup)\n\n    return (this.unregister = () => {\n      mouseMoveTarget.removeEventListener(\"mousemove\", this.mousemove)\n      mouseMoveTarget.removeEventListener(\"wheel\", this.wheel)\n      keyUpDownTarget.removeEventListener(\"keydown\", this.keydown)\n      keyUpDownTarget.removeEventListener(\"keyup\", this.keyup)\n      keyUpDownTarget.removeEventListener(\"keyup\", this.keyup)\n    })\n  }\n\n  __init8() {this.blur = () => {\n    // TODO\n  }}\n\n  unregisterListeners() {\n    _optionalChain([this, 'access', _7 => _7.unregister, 'optionalCall', _8 => _8()])\n  }\n\n  tick() {\n    const dDist = (+this.pressedKeys.zoomOut - +this.pressedKeys.zoomIn) * 0.1\n    const dRot = (-+this.pressedKeys.left + +this.pressedKeys.right) * 0.1\n    const newUDRot = clamp(\n      this.udRot + (+this.pressedKeys.up - +this.pressedKeys.down) * 0.1,\n      -Math.PI * 0.5,\n      Math.PI * 0.5,\n    )\n    if (dDist !== 0 || dRot !== 0 || newUDRot !== this.udRot) {\n      this.dist += dDist\n      this.rot += dRot\n      this.udRot = newUDRot\n      _optionalChain([this, 'access', _9 => _9.onCameraChange, 'optionalCall', _10 => _10(this.ss)])\n    }\n  }\n\n   __init9() {this.mousemove = (e) => {\n    const pagePos = V(e.pageX, e.pageY)\n    const delta = this.lastPos.to(pagePos)\n    if (e.buttons & 1 && !this.pauseCam) {\n      // zRot -= delta.x * 0.25 * DEG\n      const dRot = delta.x / 100\n      const newUDRot = clamp(\n        this.udRot + delta.y / 100,\n        -Math.PI * 0.5,\n        Math.PI * 0.5,\n      )\n      if (newUDRot !== this.udRot || dRot !== 0) {\n        this.udRot = newUDRot\n        this.rot += dRot\n        _optionalChain([this, 'access', _11 => _11.onCameraChange, 'optionalCall', _12 => _12(this.ss)])\n        e.stopImmediatePropagation()\n        e.preventDefault()\n      }\n    }\n    this.lastPos = pagePos\n  }}\n\n   __init10() {this.wheel = (e) => {\n    const newDist = clamp(this.dist + e.deltaY, 0.1, 1000)\n    if (newDist !== this.dist) {\n      this.dist = newDist\n      e.stopImmediatePropagation()\n      e.preventDefault()\n      _optionalChain([this, 'access', _13 => _13.onCameraChange, 'optionalCall', _14 => _14(this.ss)])\n    }\n  }}\n\n  get ss() {\n    return [this.udRot, this.rot, this.dist]\n  }\n\n   __init11() {this.keydown = (e) => {\n    for (const action of ACTIONS) {\n      if (this.keys[action] === e.key) {\n        this.pressedKeys[action] = true\n        e.stopImmediatePropagation()\n        e.preventDefault()\n        return\n      }\n    }\n  }}\n\n   __init12() {this.keyup = (e) => {\n    for (const action of ACTIONS) {\n      if (this.keys[action] === e.key) {\n        this.pressedKeys[action] = false\n        e.stopImmediatePropagation()\n        e.preventDefault()\n        return\n      }\n    }\n  }}\n\n  getLookAt() {\n    return OrbitCameraController.getLookAt(this.ss)\n  }\n\n  static getLookAt([udRot, rot, dist]) {\n    return M4.rotateZ(rot)\n      .rotateY(udRot)\n      .transform(M4.lookAt(V(dist, 0, 0), V3.O, V3.Z))\n  }\n\n  static invertLookAt(m) {\n    const inverse = m.transposed().scale(-1)\n    return {\n      eye: inverse.transformVector(m.getTranslation(), false),\n      dir: inverse.transformVector(V3.Z, false),\n      up: inverse.transformVector(V3.Y.negated(), false),\n    }\n  }\n\n  static toShortString(m, posFactor = 100) {\n    const [udRot, rot, dist] = this.toOrbitCameraState(m)\n    const coordString = (v, f) => Math.floor(v * f)\n    return (\n      coordString(udRot, 100) +\n      \"~\" +\n      coordString(rot, 100) +\n      \"~\" +\n      coordString(dist, 100)\n    )\n  }\n\n  static fromShortString(cam, posFactor = 100) {\n    const coord = (s, f) => +s / f\n    const [udRotStr, rotStr, distStr] = cam.split(\"~\")\n    return [coord(udRotStr, 100), coord(rotStr, 100), coord(distStr, 100)]\n  }\n}\n","\nexport default \"#version 300 es\\nprecision highp float;\\n\\nin vec4 ts_Vertex;\\nin vec2 ts_TexCoord;\\nout vec2 coord;\\nvoid main() {\\n  gl_Position = ts_Vertex;\\n  coord = ts_TexCoord;\\n}\\n\"\nconst sourceMap = {\"version\":3,\"sources\":[\"/home/runner/work/workshop/workshop/src/common/raymarch.vert\"],\"names\":[],\"mappings\":\"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA\"}\nexport { sourceMap };\n"],"names":["BoundNumberField","state","prop","setStatePartial","props","variant","size","type","value","onChange","e","target","label","FPSController","__init","this","count","__init2","lastTime","performance","now","constructor","notify","window","prototype","call","tick","time","fps","Math","floor","parseHash","hash","substring","split","map","part","key","decodeURIComponent","reduce","obj","objectToHash","o","Object","entries","encodeURIComponent","join","defaultDeserialize","x","v","NaN","isNaN","console","error","defaultSerialize","useHashState","initialState","deserialize","serialize","wait","createInitialState","useCallback","mergedState","assign","document","location","log","history","replaceState","undefined","title","setState","useState","updateHashRef","useRef","useEffect","ops","lastAccessLHS","i","length","op","fn","args","_optionalChain","_","current","_2","newState","pushState","onHashChange","addEventListener","removeEventListener","PAPER_SIZES_A","PAPER_SIZES_C","PAPER_SIZES","PaperSizeFromString","str","byName","find","name","a","b","PaperSizeFromDimensions","sort","lhs","y","rhsFn","PaperSizeToString","PAPER_SIZE_A4","INCH","fmtdeg","radiusFromSideWidth","sides","sideWidth","sin","sideWithFromRadius","radius","centerToSideFromSideWidth","tan","radiusFromCenterToSide","centerToSide","cos","sideWidthFromCenterToSide","RegularPolygon","startAngle","sideLength","Error","d","M","V3","polar","L","Z","RotStep","id","children","stepDeg","transform","openInNewTab","url","newWindow","open","opener","H","HORIZ_LINE_TO","relative","A","rx","ry","xAxisRotation","largeArcFlag","sweepFlag","p","lArcFlag","rX","rY","ARC","xRot","C","x1","y1","x2","y2","CURVE_TO","V","VERT_LINE_TO","a1","a2","MOVE_TO","LINE_TO","l","CLOSE_PATH","encode","path","modPath","lastX","lastY","c","c2","push","lastC","round","Corner","rad","prevX","prevY","prev","p1","dir1","to","toLength","p2","minus","FlyCameraController","lastPos","O","pressedKeys","__init3","pauseCam","lockUp","__init4","__init5","__init6","__init7","m","M4","copy","registerListeners","mouseMoveTarget","keyUpDownTarget","_3","unregister","_4","mousemove","keydown","keyup","unregisterListeners","_5","_6","speed","q","Control","w","s","likeO","translate","_7","_8","pagePos","pageX","pageY","delta","buttons","rot","rotateY","rotateX","times","_9","_10","preventDefault","getLookAt","static","inverse","transposed","scale","eye","transformVector","getTranslation","dir","up","Y","negated","lookAt","posFactor","coordString","f","z","invertLookAt","unit","cam","coord","sp","posStr","lookDirStr","upStr","plus","ACTIONS","OrbitCameraController","zoomIn","zoomOut","left","right","down","udRot","dist","onCameraChange","keys","__init8","__init9","__init10","__init11","__init12","toOrbitCameraState","atan","lengthXY","angleXY","wheel","blur","dDist","dRot","newUDRot","PI","ss","_11","_12","stopImmediatePropagation","newDist","deltaY","_13","_14","action","rotateZ","udRotStr","rotStr","distStr"],"sourceRoot":""}