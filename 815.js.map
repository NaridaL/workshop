{"version":3,"file":"815.js","mappings":"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","sources":["/dev/workshop/./src/common/BoundNumberField.tsx?","/dev/workshop/./src/common/FPSController.ts?","/dev/workshop/./src/common/useHashState.ts?","/dev/workshop/./src/paperBox1/PaperSize.tsx?","/dev/workshop/./src/paperBox1/common.tsx?","/dev/workshop/./src/paperBox1/svg.ts?","/dev/workshop/./src/raymarch/FlyCameraController.ts?","/dev/workshop/./src/raymarch/OrbitCameraController.ts?","/dev/workshop/./src/common/raymarch.vert?"],"sourcesContent":["import TextField, { } from \"@mui/material/TextField\"\nimport * as React from \"react\"\n\n\nexport function BoundNumberField({\n  state,\n  prop,\n  setStatePartial,\n  ...props\n}\n\n\n\n) {\n  return (\n    React.createElement(TextField, {\n      variant: \"outlined\",\n      size: \"small\",\n      type: \"number\",\n      value: state[prop],\n      onChange: (e) =>\n        setStatePartial({ [prop]: +e.target.value } )\n      ,\n      label: prop,\n      ...props,}\n    )\n  )\n}\n","/**\n * Helper class to count frames per second.\n */\nexport class FPSController {\n   __init() {this.count = 0}\n\n   __init2() {this.lastTime = performance.now()}\n  constructor(\n      notify,\n      window = 10,\n  ) {;this.notify = notify;this.window = window;FPSController.prototype.__init.call(this);FPSController.prototype.__init2.call(this);}\n\n  tick(time = performance.now()) {\n    const window = this.window\n    this.count = (this.count + 1) % window\n    if (this.count === 0) {\n      const fps = Math.floor((window * 1000) / (time - this.lastTime))\n      this.notify(fps)\n      this.lastTime = time\n    }\n  }\n}\n"," function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }import debounce from \"lodash/debounce\"\nimport mapValues from \"lodash/mapValues\"\nimport { useCallback, useEffect, useRef, useState } from \"react\"\nimport {\n  PAPER_SIZE_A4,\n\n  PaperSizeFromString,\n  PaperSizeToString,\n} from \"../paperBox1/PaperSize\"\n\nconst parseHash = (hash) => {\n  return !hash\n    ? {}\n    : hash\n        .substring(1)\n        .split(\"&\")\n        .map((part) => {\n          const [key, value] = part.split(\"=\")\n          return [decodeURIComponent(key), decodeURIComponent(value)]\n        })\n        .reduce(\n          (obj, [key, value]) => {\n            obj[key] = value\n            return obj\n          },\n          {} ,\n        )\n}\nconst objectToHash = (o) => {\n  return (\n    \"#\" +\n    Object.entries(o)\n      .map(\n        ([key, value]) =>\n          encodeURIComponent(key) + \"=\" + encodeURIComponent(value),\n      )\n      .join(\"&\")\n  )\n}\n\nconst defaultDeserialize = (\n  x,\n) =>\n  mapValues(x, (v, key) => {\n    if (\"paperSize\" === key) {\n      try {\n        return PaperSizeFromString(v)\n      } catch (e) {\n        console.error(e)\n        return PAPER_SIZE_A4\n      }\n    } else if (\"true\" === v) {\n      return true\n    } else if (\"false\" === v) {\n      return false\n    } else if (\"NaN\" === v) {\n      return NaN\n    } else if (\"undefined\" === v) {\n      return undefined\n    } else if (\"null\" === v) {\n      return null\n    } else if (\"\" === v) {\n      return \"\"\n    } else if (!isNaN(+v)) {\n      return +v\n    } else {\n      return v\n    }\n  })\nconst defaultSerialize = (x) =>\n  mapValues(x, (v, key) =>\n    key === \"paperSize\" ? PaperSizeToString(v ) : \"\" + v,\n  )\n\nexport function useHashState(\n  initialState,\n  {\n    deserialize = defaultDeserialize,\n    serialize = defaultSerialize,\n    wait = 1000,\n  } = {},\n) {\n  const createInitialState = useCallback(() => {\n    const state =\n      \"function\" === typeof initialState\n        ? (initialState )()\n        : initialState\n    // hash overrides parameter\n    const mergedState = deserialize(\n      Object.assign(serialize(state), parseHash(document.location.hash)),\n    ) \n    console.log(\"replaceState\")\n    history.replaceState(\n      undefined,\n      document.title,\n      objectToHash(serialize(mergedState)),\n    )\n\n    return mergedState\n  }, [deserialize, initialState, serialize])\n  const [state, setState] = useState(createInitialState)\n  const updateHashRef = useRef()\n  useEffect(() => _optionalChain([updateHashRef, 'access', _ => _.current, 'optionalCall', _2 => _2(state)]), [state])\n  if (!updateHashRef.current) {\n    console.log(\"pushState\")\n    updateHashRef.current = debounce(function (newState) {\n      history.pushState(\n        undefined,\n        document.title,\n        objectToHash(serialize(newState)),\n      )\n    }, wait)\n  }\n\n  useEffect(() => {\n    const onHashChange = () => {\n      setState(createInitialState())\n    }\n    window.addEventListener(\"hashchange\", onHashChange)\n    return () => {\n      window.removeEventListener(\"hashchange\", onHashChange)\n    }\n  }, [createInitialState])\n  return [state, setState]\n}\n"," function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } }import { MINUS } from \"ts3dutils\"\n\n \n// Always portrait orientation,\n\n// Always portrait orientation,\nexport const PAPER_SIZES_A = [\n  [841, 1189, \"A0\"],\n  [594, 841, \"A1\"],\n  [420, 594, \"A2\"],\n  [297, 420, \"A3\"],\n  [210, 297, \"A4\"],\n  [148, 210, \"A5\"],\n  [105, 148, \"A6\"],\n  [74, 105, \"A7\"],\n  [52, 74, \"A8\"],\n  [37, 52, \"A9\"],\n  [26, 37, \"A10\"],\n]\n\nexport function PaperSizeEquals([aw, ah], [bw, bh]) {\n  return aw === bw && bh === bw\n}\n\nexport const PAPER_SIZES_B = [\n  [1000, 1414, \"C0\"],\n  [707, 1000, \"C1\"],\n  [500, 707, \"C2\"],\n  [353, 500, \"C3\"],\n  [250, 353, \"C4\"],\n  [176, 250, \"C5\"],\n  [125, 176, \"C6\"],\n  [88, 125, \"C7\"],\n  [62, 88, \"C8\"],\n  [44, 62, \"C9\"],\n  [31, 44, \"C10\"],\n]\n\n// C size envelopes fit A size paper.\nexport const PAPER_SIZES_C = [\n  [917, 1297, \"C0\"],\n  [648, 917, \"C1\"],\n  [458, 648, \"C2\"],\n  [324, 458, \"C3\"],\n  [229, 324, \"C4\"],\n  [162, 229, \"C5\"],\n  [114, 162, \"C6\"],\n  [81, 114, \"C7\"],\n  [57, 81, \"C8\"],\n  [40, 57, \"C9\"],\n  [28, 40, \"C10\"],\n]\nexport const PAPER_SIZES = [\n  ...PAPER_SIZES_A,\n  [150, 150, \"Origami 15cm\"],\n  [100, 100, \"Origami 10cm\"],\n  [75, 75, \"Origami 7.5cm\"],\n  [215.9, 279.4, \"Letter\"],\n  [215.9, 355.6, \"Legal\"],\n]\n\nexport const ALL_PAPER_SIZES = [\n  ...PAPER_SIZES,\n  ...PAPER_SIZES_C,\n  ...PAPER_SIZES_B,\n]\n\nexport function PaperSizeFromString(str) {\n  const byName = PAPER_SIZES.find(([, , name]) => name === str)\n  if (byName) return byName\n  const [a, b] = str.split(\"x\")\n  return [+a, +b, \"Custom\"]\n}\nexport function PaperSizeFromDimensions(a, b) {\n  ;[a, b] = [a, b].sort(MINUS)\n  return _nullishCoalesce(PAPER_SIZES.find(([x, y]) => x === a && y === b), () => ( [a, b, \"Custom\"]))\n}\nexport function PaperSizeToString([a, b, name]) {\n  return name === \"Custom\" ? \"\" + a + \"x\" + b : name\n}\n\nexport const PAPER_SIZE_A4 = PAPER_SIZES_A[4]\n","import * as React from \"react\"\n\nimport { arrayRange, DEG, round10, TAU, V3 } from \"ts3dutils\"\nimport { encode, L, M, Z } from \"./svg\"\n\nexport const INCH = 25.4\nexport const fmtdeg = (x) => \"\" + round10(x / DEG, -1) + \"Â°\"\n \n\nexport const radiusFromSideWidth = (sides, sideWidth) =>\n  sideWidth / 2 / Math.sin(TAU / sides / 2)\nexport const sideWithFromRadius = (sides, radius) =>\n  radius * 2 * Math.sin(TAU / sides / 2)\nexport const centerToSideFromSideWidth = (\n  sides,\n  sideWidth,\n) => sideWidth / 2 / Math.tan(TAU / sides / 2)\nexport const radiusFromCenterToSide = (\n  sides,\n  centerToSide,\n) => centerToSide / Math.cos(TAU / sides / 2)\nexport const sideWidthFromCenterToSide = (\n  sides,\n  centerToSide,\n) => centerToSide * 2 * Math.tan(TAU / sides / 2)\n\nexport function RegularPolygon({\n  sides,\n  radius,\n  startAngle = 0,\n  sideLength = undefined,\n  ...props\n}\n\n\n\n\n) {\n  if ((undefined !== sideLength) === (undefined !== radius)) {\n    throw new Error(\"must set either sideLength or radius\")\n  }\n  if (undefined === radius) {\n    radius = radiusFromSideWidth(sides, sideLength)\n  }\n  return (\n    React.createElement('path', {\n      d: encode(\n        M(V3.polar(radius, startAngle)),\n        ...arrayRange(0, sides).map((i) =>\n          L(V3.polar(radius, startAngle + i * (TAU / sides))),\n        ),\n        Z(),\n      ),\n      ...props,}\n    )\n  )\n}\n\nexport function RotStep({\n  id,\n  children,\n  count,\n  stepDeg,\n}\n\n\n\n\n) {\n  return (\n    React.createElement(React.Fragment, null\n      , React.createElement('g', { id: id,}, children)\n      , arrayRange(0, count - 1).map((i) => (\n        React.createElement('g', {\n          id: `${id}-${i}`,\n          key: `${id}-${i}`,\n          transform: `rotate(${(i + 1) * stepDeg} 0 0)`,}\n\n          , children\n        )\n      ))\n    )\n  )\n}\n\nexport const openInNewTab = (url) => {\n  const newWindow = window.open(url, \"_blank\", \"noopener,noreferrer\")\n  if (newWindow) newWindow.opener = null\n}\n","import { SVGPathData } from \"svg-pathdata\"\n\n\n\n\n\n\n\n\n\n\n\n\nexport function H(x) {\n  return { type: SVGPathData.HORIZ_LINE_TO, relative: false, x: x }\n}\n\nexport function A(\n  rx,\n  ry,\n  xAxisRotation,\n  largeArcFlag,\n  sweepFlag,\n  p,\n) {\n  return {\n    lArcFlag: largeArcFlag,\n    rX: rx,\n    rY: ry,\n    relative: false,\n    sweepFlag: sweepFlag,\n    type: SVGPathData.ARC,\n    x: p.x,\n    xRot: 0,\n    y: p.y,\n  }\n}\n\nexport const C = (\n  x1,\n  y1,\n  x2,\n  y2,\n  x,\n  y,\n) => ({\n  type: SVGPathData.CURVE_TO,\n  x1,\n  y1,\n  x2,\n  y2,\n  x,\n  y,\n  relative: false,\n})\n\nexport const V = (y) => ({\n  type: SVGPathData.VERT_LINE_TO,\n  y,\n  relative: false,\n})\n\nexport const S = (x2, y2, x, y) => ({\n  type: SVGPathData.SMOOTH_CURVE_TO,\n  x2,\n  y2,\n  x,\n  y,\n  relative: false,\n})\n\n\n\nexport function M(a1, a2) {\n  const [x, y] = a2 === undefined ? [(a1 ).x, (a1 ).y] : [a1, a2]\n  return { type: SVGPathData.MOVE_TO, x, y, relative: false }\n}\n\nexport const m = (x, y) => ({\n  type: SVGPathData.MOVE_TO,\n  x,\n  y,\n  relative: true,\n})\n\n\nexport function L(a1, a2) {\n  const [x, y] = a2 === undefined ? [(a1 ).x, (a1 ).y] : [a1, a2]\n  return { type: SVGPathData.LINE_TO, x, y, relative: false }\n}\nexport const l = (x, y) => ({\n  type: SVGPathData.LINE_TO,\n  x,\n  y,\n  relative: true,\n})\n\nexport const Z = () => ({ type: SVGPathData.CLOSE_PATH })\n\nexport const encode = (...path) => {\n  return new SVGPathData(path).round(3).encode()\n}\n"," function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }import { DEG, M4, V, V3 } from \"ts3dutils\"\n\n/**\n * You can't use the keyboard events directly to move the camera, as they are\n * not fired often enough. Instead, we track which keys are down and tick()\n * should be called in the render loop.\n */\nexport class FlyCameraController {\n   __init() {this.lastPos = V3.O}\n  \n\n   __init2() {this.pressedKeys = {}}\n   __init3() {this.pauseCam = false}\n\n  constructor(\n     state,\n      onChange,\n      lockUp,\n  ) {;this.state = state;this.onChange = onChange;this.lockUp = lockUp;FlyCameraController.prototype.__init.call(this);FlyCameraController.prototype.__init2.call(this);FlyCameraController.prototype.__init3.call(this);FlyCameraController.prototype.__init4.call(this);FlyCameraController.prototype.__init5.call(this);FlyCameraController.prototype.__init6.call(this);FlyCameraController.prototype.__init7.call(this);}\n\n  __init4() {this.setState = (m) => {\n    m !== this.state && M4.copy(m, this.state)\n  }}\n\n  registerListeners(\n    mouseMoveTarget\n\n\n,\n    keyUpDownTarget = mouseMoveTarget,\n  ) {\n    _optionalChain([this, 'access', _3 => _3.unregister, 'optionalCall', _4 => _4()])\n    mouseMoveTarget.addEventListener(\"mousemove\", this.mousemove)\n    keyUpDownTarget.addEventListener(\"keydown\", this.keydown)\n    keyUpDownTarget.addEventListener(\"keyup\", this.keyup)\n\n    return (this.unregister = () => {\n      mouseMoveTarget.removeEventListener(\"mousemove\", this.mousemove)\n      keyUpDownTarget.removeEventListener(\"keydown\", this.keydown)\n      keyUpDownTarget.removeEventListener(\"keyup\", this.keyup)\n    })\n  }\n\n  unregisterListeners() {\n    _optionalChain([this, 'access', _5 => _5.unregister, 'optionalCall', _6 => _6()])\n  }\n\n  tick() {\n    const speed = new V3(\n      +!!this.pressedKeys.a - +!!this.pressedKeys.d,\n      +!!this.pressedKeys.q +\n        +!!this.pressedKeys.Control -\n        +!!this.pressedKeys.e -\n        +!!this.pressedKeys[\" \"],\n      +!!this.pressedKeys.w - +!!this.pressedKeys.s,\n    )\n    if (!speed.likeO()) {\n      this.state = this.state.translate(speed.toLength(0.05))\n      _optionalChain([this, 'access', _7 => _7.onChange, 'optionalCall', _8 => _8(this.state)])\n    }\n  }\n\n   __init5() {this.mousemove = (e) => {\n    const pagePos = V(e.pageX, e.pageY)\n    const delta = this.lastPos.to(pagePos)\n    if (e.buttons & 1 && !this.pauseCam) {\n      // zRot -= delta.x * 0.25 * DEG\n      const rot = M4.rotateY(delta.x * 0.25 * DEG)\n        //\n        .rotateX(delta.y * 0.25 * DEG)\n      this.state = rot.times(this.state)\n      // rot = rot.rotate(V3.O, rot.X, delta.y * 0.25 * DEG)\n      // yRot = clamp(yRot - delta.y * 0.25 * DEG, -85 * DEG, 85 * DEG)\n      _optionalChain([this, 'access', _9 => _9.onChange, 'optionalCall', _10 => _10(this.state)])\n    }\n    this.lastPos = pagePos\n  }}\n\n   __init6() {this.keydown = (e) => {\n    this.pressedKeys[e.key] = true\n    e.preventDefault()\n  }}\n   __init7() {this.keyup = (e) => {\n    this.pressedKeys[e.key] = undefined\n    e.preventDefault()\n  }}\n\n  getLookAt() {\n    return this.state\n  }\n\n  static invertLookAt(m) {\n    const inverse = m.transposed().scale(-1)\n    return {\n      eye: inverse.transformVector(m.getTranslation(), false),\n      dir: inverse.transformVector(V3.Z, false),\n      up: inverse.transformVector(V3.Y.negated(), false),\n    }\n  }\n\n  static toShortString(lookAt, posFactor = 100) {\n    const coordString = (v, f) =>\n      [v.x, v.y, v.z].map((e) => Math.floor(e * f)).join(\".\")\n    const { eye, dir, up } = FlyCameraController.invertLookAt(lookAt)\n    return (\n      coordString(eye, posFactor) +\n      \"~\" +\n      coordString(dir.unit(), 100) +\n      \"~\" +\n      coordString(up, 100)\n    )\n  }\n\n  static fromShortString(cam, posFactor = 100) {\n    const coord = (s, f) =>\n      V(s.split(\".\").map((sp) => +sp / f) )\n    const [posStr, lookDirStr, upStr] = cam.split(\"~\")\n    const eye = coord(posStr, posFactor)\n    return M4.lookAt(eye, eye.plus(coord(lookDirStr, 100)), coord(upStr, 100))\n  }\n}\n"," function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }import { clamp, M4, V, V3 } from \"ts3dutils\"\n\n \n\nconst ACTIONS = [\"zoomIn\", \"zoomOut\", \"left\", \"right\", \"up\", \"down\"] \n\n/**\n * You can't use the keyboard events directly to move the camera, as they are\n * not fired often enough. Instead, we track which keys are down and tick()\n * should be called in the render loop.\n *\n * You need to make a DOM element \"focusable\" for the key events to work.\n *\n * Example to use this in a react-controlled component:\n * ```js\n * const [lookAt, setLookAt] = useState(M4.identity)\n * const svgRef = useRef<SVGSVGElement>()\n * useEffect(() => {\n *   const camController = new OrbitCameraController((v) =>\n *     setLookAt(OrbitCameraController.getLookAt(v)),\n *   )\n *   camController.setState([0, 0.1, 200])\n *   camController.registerListeners(svgRef.current)\n *   let cancel = false\n *   function tick() {\n *     camController!.tick()\n *     if (!cancel) requestAnimationFrame(tick)\n *   }\n *   requestAnimationFrame(tick)\n *   return () => {\n *     cancel = true\n *     camController?.unregisterListeners()\n *   }\n * }, [])\n * ```\n */\nexport class OrbitCameraController {\n   __init() {this.lastPos = V3.O}\n  \n\n   __init2() {this.pressedKeys = {\n    zoomIn: false,\n    zoomOut: false,\n    left: false,\n    right: false,\n    up: false,\n    down: false,\n  }}\n   __init3() {this.pauseCam = false}\n   __init4() {this.udRot = 0.1}\n   __init5() {this.rot = 0}\n   __init6() {this.dist = 10}\n\n  constructor(\n      onCameraChange,\n      keys = {\n      zoomIn: \"w\",\n      zoomOut: \"s\",\n      left: \"a\",\n      right: \"d\",\n      up: \" \",\n      down: \"Control\",\n    },\n  ) {;this.onCameraChange = onCameraChange;this.keys = keys;OrbitCameraController.prototype.__init.call(this);OrbitCameraController.prototype.__init2.call(this);OrbitCameraController.prototype.__init3.call(this);OrbitCameraController.prototype.__init4.call(this);OrbitCameraController.prototype.__init5.call(this);OrbitCameraController.prototype.__init6.call(this);OrbitCameraController.prototype.__init7.call(this);OrbitCameraController.prototype.__init8.call(this);OrbitCameraController.prototype.__init9.call(this);OrbitCameraController.prototype.__init10.call(this);OrbitCameraController.prototype.__init11.call(this);OrbitCameraController.prototype.__init12.call(this);}\n\n  __init7() {this.setState = (m) => {\n    ;[this.udRot, this.rot, this.dist] =\n      OrbitCameraController.toOrbitCameraState(m)\n  }}\n\n  static toOrbitCameraState(m) {\n    if (m instanceof M4) {\n      const eye = m\n        .transposed()\n        .scale(-1)\n        .transformVector(m.getTranslation(), false)\n      return [Math.atan(eye.z / eye.lengthXY()), eye.angleXY(), eye.length()]\n    } else {\n      return m\n    }\n  }\n\n  registerListeners(\n    mouseMoveTarget\n\n\n,\n    keyUpDownTarget = mouseMoveTarget,\n  ) {\n    _optionalChain([this, 'access', _5 => _5.unregister, 'optionalCall', _6 => _6()])\n    mouseMoveTarget.addEventListener(\"mousemove\", this.mousemove)\n    mouseMoveTarget.addEventListener(\"wheel\", this.wheel)\n    keyUpDownTarget.addEventListener(\"keydown\", this.keydown)\n    keyUpDownTarget.addEventListener(\"keyup\", this.keyup)\n    keyUpDownTarget.addEventListener(\"blur\", this.keyup)\n\n    return (this.unregister = () => {\n      mouseMoveTarget.removeEventListener(\"mousemove\", this.mousemove)\n      mouseMoveTarget.removeEventListener(\"wheel\", this.wheel)\n      keyUpDownTarget.removeEventListener(\"keydown\", this.keydown)\n      keyUpDownTarget.removeEventListener(\"keyup\", this.keyup)\n      keyUpDownTarget.removeEventListener(\"keyup\", this.keyup)\n    })\n  }\n\n  __init8() {this.blur = () => {\n    // TODO\n  }}\n\n  unregisterListeners() {\n    _optionalChain([this, 'access', _7 => _7.unregister, 'optionalCall', _8 => _8()])\n  }\n\n  tick() {\n    const dDist = (+this.pressedKeys.zoomOut - +this.pressedKeys.zoomIn) * 0.1\n    const dRot = (-+this.pressedKeys.left + +this.pressedKeys.right) * 0.1\n    const newUDRot = clamp(\n      this.udRot + (+this.pressedKeys.up - +this.pressedKeys.down) * 0.1,\n      -Math.PI * 0.5,\n      Math.PI * 0.5,\n    )\n    if (dDist !== 0 || dRot !== 0 || newUDRot !== this.udRot) {\n      this.dist += dDist\n      this.rot += dRot\n      this.udRot = newUDRot\n      _optionalChain([this, 'access', _9 => _9.onCameraChange, 'optionalCall', _10 => _10(this.ss)])\n    }\n  }\n\n   __init9() {this.mousemove = (e) => {\n    const pagePos = V(e.pageX, e.pageY)\n    const delta = this.lastPos.to(pagePos)\n    if (e.buttons & 1 && !this.pauseCam) {\n      // zRot -= delta.x * 0.25 * DEG\n      const dRot = delta.x / 100\n      const newUDRot = clamp(\n        this.udRot + delta.y / 100,\n        -Math.PI * 0.5,\n        Math.PI * 0.5,\n      )\n      if (newUDRot !== this.udRot || dRot !== 0) {\n        this.udRot = newUDRot\n        this.rot += dRot\n        _optionalChain([this, 'access', _11 => _11.onCameraChange, 'optionalCall', _12 => _12(this.ss)])\n        e.stopImmediatePropagation()\n        e.preventDefault()\n      }\n    }\n    this.lastPos = pagePos\n  }}\n\n   __init10() {this.wheel = (e) => {\n    const newDist = clamp(this.dist + e.deltaY, 0.1, 1000)\n    if (newDist !== this.dist) {\n      this.dist = newDist\n      e.stopImmediatePropagation()\n      e.preventDefault()\n      _optionalChain([this, 'access', _13 => _13.onCameraChange, 'optionalCall', _14 => _14(this.ss)])\n    }\n  }}\n\n  get ss() {\n    return [this.udRot, this.rot, this.dist]\n  }\n\n   __init11() {this.keydown = (e) => {\n    for (const action of ACTIONS) {\n      if (this.keys[action] === e.key) {\n        this.pressedKeys[action] = true\n        e.stopImmediatePropagation()\n        e.preventDefault()\n        return\n      }\n    }\n  }}\n\n   __init12() {this.keyup = (e) => {\n    for (const action of ACTIONS) {\n      if (this.keys[action] === e.key) {\n        this.pressedKeys[action] = false\n        e.stopImmediatePropagation()\n        e.preventDefault()\n        return\n      }\n    }\n  }}\n\n  getLookAt() {\n    return OrbitCameraController.getLookAt(this.ss)\n  }\n\n  static getLookAt([udRot, rot, dist]) {\n    return M4.rotateZ(rot)\n      .rotateY(udRot)\n      .transform(M4.lookAt(V(dist, 0, 0), V3.O, V3.Z))\n  }\n\n  static invertLookAt(m) {\n    const inverse = m.transposed().scale(-1)\n    return {\n      eye: inverse.transformVector(m.getTranslation(), false),\n      dir: inverse.transformVector(V3.Z, false),\n      up: inverse.transformVector(V3.Y.negated(), false),\n    }\n  }\n\n  static toShortString(m, posFactor = 100) {\n    const [udRot, rot, dist] = this.toOrbitCameraState(m)\n    const coordString = (v, f) => Math.floor(v * f)\n    return (\n      coordString(udRot, 100) +\n      \"~\" +\n      coordString(rot, 100) +\n      \"~\" +\n      coordString(dist, 100)\n    )\n  }\n\n  static fromShortString(cam, posFactor = 100) {\n    const coord = (s, f) => +s / f\n    const [udRotStr, rotStr, distStr] = cam.split(\"~\")\n    return [coord(udRotStr, 100), coord(rotStr, 100), coord(distStr, 100)]\n  }\n}\n","\nexport default \"#version 300 es\\nprecision highp float;\\n\\nin vec4 ts_Vertex;\\nin vec2 ts_TexCoord;\\nout vec2 coord;\\nvoid main() {\\n  gl_Position = ts_Vertex;\\n  coord = ts_TexCoord;\\n}\\n\"\nconst sourceMap = {\"version\":3,\"sources\":[\"/home/runner/work/workshop/workshop/src/common/raymarch.vert\"],\"names\":[],\"mappings\":\"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA\"}\nexport { sourceMap };\n"],"names":["BoundNumberField","state","prop","setStatePartial","props","variant","size","type","value","onChange","e","target","label","FPSController","__init","this","count","__init2","lastTime","performance","now","constructor","notify","window","prototype","call","tick","time","fps","Math","floor","parseHash","hash","substring","split","map","part","key","decodeURIComponent","reduce","obj","objectToHash","o","Object","entries","encodeURIComponent","join","defaultDeserialize","x","v","NaN","isNaN","console","error","defaultSerialize","useHashState","initialState","deserialize","serialize","wait","createInitialState","useCallback","mergedState","assign","document","location","log","history","replaceState","undefined","title","setState","useState","updateHashRef","useRef","useEffect","ops","lastAccessLHS","i","length","op","fn","args","_optionalChain","_","current","_2","newState","pushState","onHashChange","addEventListener","removeEventListener","PAPER_SIZES_A","PAPER_SIZES_C","PAPER_SIZES","PaperSizeFromString","str","byName","find","name","a","b","PaperSizeFromDimensions","sort","lhs","y","rhsFn","PaperSizeToString","PAPER_SIZE_A4","INCH","fmtdeg","radiusFromSideWidth","sides","sideWidth","sin","sideWithFromRadius","radius","centerToSideFromSideWidth","tan","radiusFromCenterToSide","centerToSide","cos","sideWidthFromCenterToSide","RegularPolygon","startAngle","sideLength","Error","d","M","V3","polar","L","Z","RotStep","id","children","stepDeg","transform","openInNewTab","url","newWindow","open","opener","H","HORIZ_LINE_TO","relative","A","rx","ry","xAxisRotation","largeArcFlag","sweepFlag","p","lArcFlag","rX","rY","ARC","xRot","V","VERT_LINE_TO","a1","a2","MOVE_TO","LINE_TO","l","CLOSE_PATH","encode","path","round","FlyCameraController","lastPos","O","pressedKeys","__init3","pauseCam","lockUp","__init4","__init5","__init6","__init7","m","M4","copy","registerListeners","mouseMoveTarget","keyUpDownTarget","_3","unregister","_4","mousemove","keydown","keyup","unregisterListeners","_5","_6","speed","q","Control","w","s","likeO","translate","toLength","_7","_8","pagePos","pageX","pageY","delta","to","buttons","rot","rotateY","rotateX","times","_9","_10","preventDefault","getLookAt","static","inverse","transposed","scale","eye","transformVector","getTranslation","dir","up","Y","negated","lookAt","posFactor","coordString","f","z","invertLookAt","unit","cam","coord","sp","posStr","lookDirStr","upStr","plus","ACTIONS","OrbitCameraController","zoomIn","zoomOut","left","right","down","udRot","dist","onCameraChange","keys","__init8","__init9","__init10","__init11","__init12","toOrbitCameraState","atan","lengthXY","angleXY","wheel","blur","dDist","dRot","newUDRot","PI","ss","_11","_12","stopImmediatePropagation","newDist","deltaY","_13","_14","action","rotateZ","udRotStr","rotStr","distStr"],"sourceRoot":""}