(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{111:function(t,o,e){"use strict";e.r(o),e.d(o,"quickhull",(function(){return d}));var n=e(143),a=e(148),r=e(149),s=e(0);const i="C:\\Users\\aval\\tsdev\\workshop\\src\\delta3d\\index.tsx";r.a("blue").gl();class c{__init3(){this.children=[]}constructor(t=n.c.IDENTITY,o,e,...a){this.transform=t,this.mesh=o,this.color=e,c.prototype.__init3.call(this),a.forEach(t=>this.add(t))}add(...t){for(const o of t)this.children.push(o),o.parent=this}getTransform(t){let o=t.transform;for(;t.parent!=this;)o=(t=t.parent).transform.times(o);return o}withGimbal(){return this.gimbal=!0,this}}const l=new c;function m(t,o){return t.map(t=>{const e=o.xy().distanceTo(t);return o.z+Math.sqrt(144-e*e)+1})}function d(t){const o={pos:Object(n.j)(.75,0,1),lookDir:Object(n.j)(0,0,-1),axisPoss:[0,0,0]},e=()=>{localStorage.setItem("viewState",JSON.stringify({pos:o.pos.toArray(),lookDir:o.lookDir.toArray(),axisPoss:o.axisPoss}))};(()=>{if(null!=localStorage.getItem("viewState")){const t=JSON.parse(localStorage.getItem("viewState"));o.pos=n.k.fromArray(t.pos),o.lookDir=n.k.fromArray(t.lookDir),o.axisPoss=t.axisPoss||o.axisPoss}})();const s=a.b.cube();console.log("cubeMesh",s);const i=a.b.rotation([n.k.O,Object(n.j)(1,0,1)],{anchor:n.k.O,dir1:n.k.Z},n.h,16),d=(a.b.plane(),a.b.sphere(1).computeWireframeFromFlatTrianglesClosedMesh().compile()),f=a.b.spiral([Object(n.j)(-.1,1),Object(n.j)(0,1.1),Object(n.j)(.1,1,0)],{anchor:n.k.O,dir1:n.k.X},320*n.h,5120,.2).computeNormalsFromFlatTriangles().compile();console.log("spiralMesh",f);const u=a.b.rotation([n.k.Y,n.k.XY],{anchor:n.k.O,dir1:n.k.X},2*Math.PI,16,!0),p=a.b.rotation([n.k.O,n.k.X,Object(n.j)(1,0,1),n.k.Z],{anchor:n.k.O,dir1:n.k.Z},2*n.g,3),v=new a.a(t.ARRAY_BUFFER,Float32Array);let g=0;const h=r.d("yellow","black").colors(6,"gl");console.log(d);const b=[],k=[],O=[],x=[];let w,y=[];l.add(new c(n.c.translate(Object(n.j)(-.5,-.5,-1)).scale(30,30,1),s,r.b("lightgreen").gl()).withGimbal(),w=new c(n.c.translate(0,0,5),void 0,void 0,new c(n.c.scale(3,3,1).rotateZ(Math.PI/3),p,r.b("orange").gl()),new c(n.c.translate(0,0,-1),i,r.b("silver").gl()),...[0,1,2].flatMap(t=>[0,1].map(o=>x[2*t+o]=new c(n.c.scale(.2).translate(1.5,o?1.5:-1.5,.5).rotateZ(n.h*(1/3*t)),d,h[2*t+o])))),...[0,1,2,3,4,5].map(t=>y[t]=new c(void 0,u,h[t])),...[0,1,2].map(t=>new c(n.c.translate(10,0,0).rotateZ(2*n.g/3*t),void 0,void 0,k[t]=new c(n.c.rotateY(-n.g/2),f,r.b("green").gl()),new c(n.c.scale(.4).translate(-2.5,0,0),s,r.b("cyan").gl()),b[t]=new c(n.c.translate(0,0,o.axisPoss[t]),void 0,void 0,new c(n.c.translate(-.5,-.5).scale(2,3,1),s,r.b("blue").gl()),...[0,1].map(o=>O[2*t+o]=new c(n.c.scale(.2).translate(-1,o?1.5:-1.5,.5),d,h[2*t+o]))))));const j=[0,1,2].map(t=>l.getTransform(b[t]).transformPoint(Object(n.j)(-2.5,0,0)).xy());function _(){[0,1,2].forEach(t=>{b[t].transform=n.c.translate(0,0,o.axisPoss[t]),k[t].transform=n.c.scale(1,.5,.5).rotateX(n.h*-o.axisPoss[t]/.2).rotateY(-n.g/2)});const[t,e,a]=[0,1,2].map(t=>l.getTransform(b[t]).transformPoint(Object(n.j)(-2.5,0,0))),r=function(t,o,e,a,r,s){const i=t.to(e).unit(),c=t.to(r).rejectedFrom1(i).unit(),l=n.c.forSys(i,c,void 0,t),m=t.to(e).length(),d=t.to(r).dot(i),f=t.to(r).dot(c),u=(o*o-a*a+m*m)/(2*m),p=(o*o-s*s-2*d*u+d*d+f*f)/(2*f),v=Object(n.j)(u,p,Math.sqrt(o*o-u*u-p*p));return l.transformPoint(v)}(e,12,t,12,a,12);w.transform=n.c.translate(r);for(let t=0;t<6;t++){const o=l.getTransform(O[t]).O,e=l.getTransform(x[t]).O;y[t].transform=n.c.scale(12,.1,.1).rotateAB(n.k.X,o.to(e)).translate(o)}}o.axisPoss=m(j,n.k.O),_();const P=a.c.create("\n\tuniform mat4 ts_ModelViewMatrix;\n\tuniform mat3 ts_NormalMatrix;\n\tuniform mat4 ts_ModelViewProjectionMatrix;\n\tuniform float pointSize;\n\n\tattribute vec4 ts_Vertex;\n\tattribute vec3 ts_Normal;\n\n\tvarying vec3 coordUVQ;\n\tvarying vec2 coord;\n\tvarying vec3 normal;\n\tvarying vec3 position;\n\n\tvoid main() {\n\n\t  gl_Position = ts_ModelViewProjectionMatrix * ts_Vertex;\n\t  gl_PointSize = pointSize;\n\n\t  normal =ts_Normal;\n\t  vec4 position4 = ts_ModelViewMatrix * ts_Vertex;\n\t  position = position4.xyz;\n\t}\n  ","\n\tprecision highp float;\n\n\tuniform sampler2D texture;\n\tuniform vec3 lightPos;\n\tuniform vec4 color;\n\n\tvarying vec3 coordUVQ;\n\tvarying vec2 coord;\n\tvarying vec3 normal;\n\tvarying vec3 position;\n\n\tvoid main() {\n\t\tvec3 normal1 = normalize(normal);\n\t\tvec3 lightPos = vec3(1000, 2000, 4000);\n\t\tvec3 lightDir = normalize(position.xyz - lightPos);\n        float uMaterialShininess = 256.0;\n\t\tfloat lightIntensity = 0.2 + 0.8 * max(0.0, -dot(lightDir, normal1));\n\t\tgl_FragColor = vec4(normal,1.0);\n\t\tgl_FragColor = vec4(vec3(color) * lightIntensity, 1);\n\t}\n\t  ");t.clearColor(1,1,1,0),t.cullFace(t.BACK);const M=()=>{t.matrixMode(t.PROJECTION),t.loadIdentity(),t.perspective(70,t.canvas.width/t.canvas.height,.1,1e3),t.lookAt(Object(n.j)(.75,0,1),Object(n.j)(.75,0,0),n.k.Y),t.matrixMode(t.MODELVIEW)};M(),t.pointSize(10),t.enable(t.CULL_FACE),t.enable(t.DEPTH_TEST),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA);let E={};console.log(t.canvas),t.canvas.contentEditable="true",t.canvas.focus(),t.canvas.onkeydown=function(o){E[o.key]=!0,"2"===o.key&&M(),"1"===o.key&&(t.matrixMode(t.PROJECTION),t.loadIdentity(),t.perspective(70,t.canvas.width/t.canvas.height,.1,1e3),t.lookAt(Object(n.j)(0,.5,2.2),n.k.O,n.k.Y),t.matrixMode(t.MODELVIEW))},t.canvas.onkeypress=function(t){new n.k(0,0,0)},t.canvas.onkeyup=function(t){E[t.key]=!1};let I=n.k.O,T=n.c.IDENTITY;function D(o){t.pushMatrix(),t.multMatrix(o.transform),o.gimbal&&t.drawGimbal(.1),o.mesh&&P.uniforms({color:o.color,pointSize:12,lightPos:Object(n.j)(100,0,100).toLength(-1)}).draw(o.mesh),o.children.forEach(D),t.popMatrix()}function S(t,o){return+!!E[t]-+!!E[o]}t.canvas.onmousemove2=function(t){const o=Object(n.j)(t.pageX,t.pageY),e=I.to(o);1&t.buttons&&(T=T.rotateZ(.25*e.x*n.b),T=T.rotateX(.25*e.y*n.b)),I=o},t.canvas.onmousemove=function(t){const e=Object(n.j)(t.pageX,t.pageY),a=I.to(e);if(1&t.buttons){const t=n.c.rotateY(.25*-a.x*n.b).rotateX(.25*-a.y*n.b);o.lookDir=t.transformVector(o.lookDir).unit()}I=e};const N=[["u","j"],["i","k"],["o","l"]];return v.data[g++]=n.k.O,v.data[g++]=n.k.O,t.animate((function(a,s){const i=n.c.rotateX(70*n.b).translate(0,0,3).transformPoint(n.k.polar(2,a/500,1+a/1e5));o.axisPoss=m(j,i),v.data[g++]=i,v.compile(),_();for(let t=0;t<3;t++){const n=.1*S(...N[t]);0!==n&&(o.axisPoss[t]+=n,_(),e())}const c=new n.k(+!!E.w-+!!E.s,+!!E.a-+!!E.d,+!!E.e-+!!E.q+ +!!E[" "]).times(.05);if(!c.likeO()){const t=o.lookDir;o.pos=o.pos.plus(n.c.forSys(t,n.k.Y.cross(t).unit()).transformVector(c)),e()}t.matrixMode(t.PROJECTION),t.loadIdentity(),t.perspective(70,t.canvas.width/t.canvas.height,.1,1e3),t.lookAt(o.pos,o.pos.plus(o.lookDir),n.k.Y),t.matrixMode(t.MODELVIEW),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.loadIdentity(),t.rotate(-90,1,0,0),t.drawGimbal(.1),D(l),P.uniforms({color:r.b("red").gl()}).drawBuffers({ts_Vertex:v},void 0,t.LINE_STRIP)}))}o.default=()=>{const t=Object(s.useRef)(null);return Object(s.useEffect)(()=>{const o=a.d.create({canvas:t.current});o.fixCanvasRes(),o.addResizeListener(),d(o)},[]),s.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%"},__self:void 0,__source:{fileName:i,lineNumber:539}},s.createElement("canvas",{ref:t,style:{flexGrow:1},tabIndex:0,__self:void 0,__source:{fileName:i,lineNumber:540}}))}}}]);