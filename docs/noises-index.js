(self.webpackChunkworkshop=self.webpackChunkworkshop||[]).push([[388],{8881:(e,t,o)=>{"use strict";o.r(t),o.d(t,{band:()=>x,default:()=>V});var n=o(6800),r=o(260),a=o(1459),i=o(9975),s=o(9905),c=o(4881),l=o(5270),d=o(7392),u=o(9526),f=o(2182),m=o(9392),v=o(1641);const p="C:\\Users\\aval\\tsdev\\workshop\\src\\noises\\index.tsx",_=(0,f.Nv)(512,(()=>f.V3.polar(1,2*(Math.random()-.5)*Math.PI))),h={xOffset:0,yOffset:0,xScale:64,yScale:64,bandCount:2,a:.5},g=(e,t,o)=>{const n=0|e,r=n+1,a=0|t,i=a+1,s=e=>e*e*(3-2*e),c=(e,t,o,n)=>{const r=o-e,a=n-t;return(0,f.en)(_,59*e+t).dot(new f.V3(r,a,0))},l=c(n,a,e,t),d=c(r,a,e,t),u=(0,f.t7)(l,d,o?s(e-n):e-n),m=c(n,i,e,t),v=c(r,i,e,t),p=(0,f.t7)(m,v,o?s(e-n):e-n);return(0,f.t7)(u,p,o?s(t-a):t-a)},x=(e,t,o,n)=>(0,f.t7)(e,t,Math.floor(4*(0,f.kL)(e,t,n))/3);const y=(0,s.Z)((e=>({sidebar:{display:"flex",flexDirection:"column",width:256,padding:e.spacing(1),alignItems:"stretch","& > *":{margin:e.spacing(1)}},media:{height:0,paddingTop:"100%"}})));function M({state:e,prop:t,setStatePartial:o,...n}){return u.createElement(l.Z,{variant:"outlined",size:"small",type:"number",value:e[t],onChange:e=>o({[t]:+e.target.value}),label:t,...n,__self:this,__source:{fileName:p,lineNumber:601}})}const V=()=>{const e=(0,u.useRef)(null),[t,s]=(0,v.q)(h),l=(0,u.useCallback)((e=>s((t=>({...t,...e})))),[s]),_=((0,u.useRef)(),(0,u.useRef)(Object.assign({},t))),x=y(),V=(0,c.Z)();return(0,u.useEffect)((()=>{const t=m.ZG.create({canvas:e.current});t.fixCanvasRes(),t.addResizeListener(),async function(e,t,n){let r=!0;const a=512,i=new Uint8Array(512*a),s=new m.xE(a,512,{format:e.RED,type:e.UNSIGNED_BYTE,internalFormat:e.R8}),c=new m.xE(256,256,{format:e.RG,type:e.FLOAT,internalFormat:e.RG32F,data:f.V3.packXY((0,f.Nv)(65536,(()=>f.V3.polar(1,2*(Math.random()-.5)*Math.PI))))}),l=()=>{let e=1/0,t=-1/0;for(let o=0;o<512;o++)for(let s=0;s<a;s++){const c=(0,f.uZ)(.8*(g(n.xOffset+s/n.xScale,n.yOffset+o/n.yScale,r)+.5),0,1),l=Math.random();i[o*a+s]=Math.floor(4*c)/3*255,t=Math.max(t,l),e=Math.min(e,l)}i[0]=0,s.setData(i)};l();const d=m.Kj.plane({detail:128}),u=m.Kj.sphere(0).computeWireframeFromFlatTrianglesClosedMesh().compile();!function(e){const t=[],o=Math.sqrt(3)/2,n=Math.cos(Math.PI/3),r=2*Math.asin(1/Math.sqrt(3));for(let a=-0;a<2;a++)for(let i=-0;i<2;i++)for(let s=-0;s<1;s++){const c=a+(i%2==0?0:n);t.push(e.transform(f.M4.scale(1,.01,.01).translate(c,i*o,s*o)),e.transform(f.M4.scale(1,.01,.01).rotateZ(Math.PI/3).translate(c,i*o,s*o)),e.transform(f.M4.scale(1,.01,.01).rotateZ(Math.PI/3*2).translate(c,i*o,s*o)),e.transform(f.M4.scale(1,.01,.01).rotateZ(Math.PI/2).rotateX((Math.PI-r)/2).translate(c,i*o,s*o)),e.transform(f.M4.scale(1,.01,.01).rotateY(-Math.PI/3*2).rotateX(Math.PI/2-r).translate(c,i*o,s*o)),e.transform(f.M4.scale(1,.01,.01).rotateY(-Math.PI/3).rotateX(Math.PI/2-r).translate(c,i*o,s*o)))}const[a,...i]=t;a.concat(...i)}(m.Kj.rotation([f.V3.Y,f.V3.XY],{anchor:f.V3.O,dir1:f.V3.X},2*Math.PI,3,!0)),console.log(u);const v=m.ex.create("\n      uniform mat4 ts_ModelViewProjectionMatrix;\n      attribute vec4 ts_Vertex;\n      uniform float pointSize;\n      varying vec4 foo;\n      void main() {\n        foo = vec4(1.0, 1.0, 1.0, 1.0);\n        gl_Position = ts_ModelViewProjectionMatrix * ts_Vertex;\n        gl_PointSize = pointSize;\n      }\n    ","\n      precision highp float;\n      uniform vec4 color;\n      varying vec4 bar;\n      void main() {\n        gl_FragColor = color;\n        if (length(gl_PointCoord - vec2(0.5, 0.5)) > 0.5) {\n          discard;\n        }\n      }\n    "),p=(m.ex.create("#version 300 es\n      precision highp float;\n      \n      uniform mat4 ts_ModelViewProjectionMatrix;\n      in vec4 ts_Vertex;\n      uniform float pointSize;\n      uniform vec2 scale;\n      uniform vec2 offset;\n      in vec3 ts_TexCoordUVQ;\n      in vec2 ts_TexCoord;\n      out vec3 coordUVQ;\n      out float n;\n      out vec2 coord;\n      void main() {\n        vec2 texCoordAdjusted = offset + ts_TexCoord * scale;\n        n = 0.0;  \n        gl_Position = ts_ModelViewProjectionMatrix * \n          (ts_Vertex + vec4(0.0, 0.0, n, 0.0));\n        gl_PointSize = pointSize;\n        coordUVQ = ts_TexCoordUVQ;\n        coord = texCoordAdjusted;\n      }\n  ","#version 300 es\n      precision highp float;\n      \n      uniform sampler2D texture;\n      uniform vec4 colorPrimary;\n      uniform vec4 colorBg;\n      uniform int bandCount;\n      in float n;\n      in vec2 coord;\n      out vec4 fragColor;\n      void main() {\n        float fraction = (n + 0.5) * 0.5;\n        fragColor = mix(colorBg, colorPrimary, fraction);\n        \n        if (length(gl_PointCoord - vec2(0.5, 0.5)) > 0.5) {\n          discard;\n        }\n      }\n    "),m.ex.create("#version 300 es\n      precision highp float;\n      \n      uniform mat4 ts_ModelViewProjectionMatrix;\n      in vec4 ts_Vertex;\n      uniform vec2 scale;\n      uniform vec2 offset;\n      in vec3 ts_TexCoordUVQ;\n      in vec2 ts_TexCoord;\n      out vec3 coordUVQ;\n      out float n;\n      out vec2 coord;\n      void main() {\n        vec2 texCoordAdjusted = offset + ts_TexCoord * scale;\n        gl_Position = ts_ModelViewProjectionMatrix * ts_Vertex;\n        coordUVQ = ts_TexCoordUVQ;\n        coord = texCoordAdjusted;\n      }\n  ",(await o.e(3).then(o.t.bind(o,4003,17))).default)),_=(m.ex.create("\n      uniform mat4 ts_ModelViewProjectionMatrix;\n      attribute vec4 ts_Vertex;\n      uniform float pointSize;\n      attribute vec3 ts_TexCoordUVQ;\n      attribute vec2 ts_TexCoord;\n      varying vec4 foo;\n      varying vec3 coordUVQ;\n      varying vec2 coord;\n      void main() {\n        foo = vec4(1.0, 1.0, 1.0, 1.0);\n        gl_Position = ts_ModelViewProjectionMatrix * ts_Vertex;\n        gl_PointSize = pointSize;\n        coordUVQ = ts_TexCoordUVQ;\n        coord = ts_TexCoord;\n      }\n    ","\n      precision highp float;\n      uniform sampler2D texture;\n      uniform vec4 colorPrimary;\n      uniform vec4 colorBg;\n      varying vec4 bar;\n      varying vec3 coordUVQ;\n      varying vec2 coord;\n      void main() {\n        float fraction = texture2D(texture, coord).r;\n        gl_FragColor = mix(colorBg, colorPrimary, fraction);\n        \n        if (length(gl_PointCoord - vec2(0.5, 0.5)) > 0.5) {\n          discard;\n        }\n      }\n    "),{pos:(0,f.V)(.75,0,1),lookDir:(0,f.V)(0,0,-1)});(()=>{if(null!=localStorage.getItem("viewState")){const e=JSON.parse(localStorage.getItem("viewState"));_.pos=f.V3.fromArray(e.pos),_.lookDir=f.V3.fromArray(e.lookDir)}})(),e.clearColor(...t.background),e.cullFace(e.BACK);const h=()=>{e.matrixMode(e.PROJECTION),e.loadIdentity(),e.perspective(70,e.canvas.width/e.canvas.height,.1,1e3),e.lookAt((0,f.V)(.75,0,1),(0,f.V)(.75,0,0),f.V3.Y),e.matrixMode(e.MODELVIEW)};h(),e.pointSize(10),e.disable(e.CULL_FACE),e.enable(e.DEPTH_TEST),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA);const x={};console.log(e.canvas),e.canvas.contentEditable="true",e.canvas.focus(),e.canvas.onkeydown=function(t){x[t.key]=!0,"o"===t.key&&(r=!r,l()),"2"===t.key&&h(),"1"===t.key&&(e.matrixMode(e.PROJECTION),e.loadIdentity(),e.perspective(70,e.canvas.width/e.canvas.height,.1,1e3),e.lookAt((0,f.V)(0,.5,2.2),f.V3.O,f.V3.Y),e.matrixMode(e.MODELVIEW))},e.canvas.onkeypress=function(e){new f.V3(0,0,0)},e.canvas.onkeyup=function(e){x[e.key]=!1};let y=f.V3.O,M=f.M4.IDENTITY;e.canvas.onmousemove2=function(e){const t=(0,f.V)(e.pageX,e.pageY),o=y.to(t);1&e.buttons&&(M=M.rotateZ(.25*o.x*f.Co),M=M.rotateX(.25*o.y*f.Co)),y=t},e.canvas.onmousemove=function(e){const t=(0,f.V)(e.pageX,e.pageY),o=y.to(t);if(1&e.buttons){const e=f.M4.rotateY(.25*-o.x*f.Co).rotateX(.25*-o.y*f.Co);_.lookDir=e.transformVector(_.lookDir).unit()}y=t},Object.assign(e.animate((function(o,r){const a=new f.V3(+!!x.w-+!!x.s,+!!x.a-+!!x.d,+!!x.e-+!!x.q+ +!!x[" "]).times(.05);if(!a.likeO()){const e=_.lookDir;_.pos=_.pos.plus(f.M4.forSys(e,f.V3.Y.cross(e).unit()).transformVector(a)),localStorage.setItem("viewState",JSON.stringify({pos:_.pos.toArray(),lookDir:_.lookDir.toArray()}))}e.matrixMode(e.PROJECTION),e.loadIdentity(),e.perspective(70,e.canvas.width/e.canvas.height,.1,1e3),e.lookAt(_.pos,_.pos.plus(_.lookDir),f.V3.Y),e.matrixMode(e.MODELVIEW),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.loadIdentity(),e.pushMatrix(),e.translate(.25,-.5,0),s.bind(0),c.bind(1),p.uniforms({a:n.a,colorPrimary:t.primary,colorSecondary:t.secondary,colorBg:t.background,scale:[n.xScale,n.yScale],offset:[n.xOffset,n.yOffset],bandCount:n.bandCount,highResTimeStamp:o,gradients:1}).draw(d),e.popMatrix(),e.pushMatrix(),e.translate(-.75,0,0),e.scale(.5),e.rotate(-90,1,0,0),p.uniforms({colorPrimary:t.primary,colorBg:t.background,pointSize:12,texture:0}).draw(u),v.uniforms({color:t.primary,pointSize:12}).draw(u,e.LINES),e.popMatrix()})),{redoTex:l})}(t,{background:d.iv(V.palette.background.default).gl(),primary:d.iv(V.palette.primary.main).gl(),secondary:d.iv(V.palette.secondary.main).gl()},_.current)}),[V.palette.background.default,V.palette.primary.main,V.palette.secondary.main]),(0,u.useEffect)((()=>{Object.assign(_.current,t)}),[t]),u.createElement(a.Z,{container:!0,style:{height:"99%"},__self:void 0,__source:{fileName:p,lineNumber:652}},u.createElement(a.Z,{item:!0,xs:12,md:9,__self:void 0,__source:{fileName:p,lineNumber:653}},u.createElement("div",{style:{height:"100%"},__self:void 0,__source:{fileName:p,lineNumber:654}},u.createElement("canvas",{ref:e,style:{width:"100%",height:"100%"},tabIndex:0,__self:void 0,__source:{fileName:p,lineNumber:655}}))),u.createElement(a.Z,{item:!0,xs:12,md:3,className:x.sidebar,__self:void 0,__source:{fileName:p,lineNumber:662}},u.createElement(n.Z,{__self:void 0,__source:{fileName:p,lineNumber:663}},u.createElement(r.Z,{__self:void 0,__source:{fileName:p,lineNumber:664}},"Test with various noise generation functions.")),u.createElement(M,{state:t,setStatePartial:l,prop:"xOffset",__self:void 0,__source:{fileName:p,lineNumber:668}}),u.createElement(M,{state:t,setStatePartial:l,prop:"yOffset",__self:void 0,__source:{fileName:p,lineNumber:669}}),u.createElement(M,{state:t,setStatePartial:l,prop:"xScale",__self:void 0,__source:{fileName:p,lineNumber:670}}),u.createElement(M,{state:t,setStatePartial:l,prop:"yScale",__self:void 0,__source:{fileName:p,lineNumber:671}}),u.createElement(M,{state:t,setStatePartial:l,prop:"bandCount",__self:void 0,__source:{fileName:p,lineNumber:672}}),u.createElement("div",{__self:void 0,__source:{fileName:p,lineNumber:673}},u.createElement(i.Z,{value:t.a,onChange:(e,t)=>l({a:t}),min:0,max:1,step:.01,__self:void 0,__source:{fileName:p,lineNumber:674}}))))}},1641:(e,t,o)=>{"use strict";o.d(t,{q:()=>u});var n=o(6897),r=o.n(n),a=o(508),i=o.n(a),s=o(9526);const c=e=>"#"+Object.entries(e).map((([e,t])=>encodeURIComponent(e)+"="+encodeURIComponent(t))).join("&"),l=e=>i()(e,(e=>"true"===e||"false"!==e&&("NaN"===e?NaN:"undefined"===e?void 0:"null"===e?null:isNaN(+e)?e:+e))),d=e=>i()(e,(e=>""+e));function u(e,{deserialize:t=l,serialize:o=d,wait:n=1e3}={}){const a=(0,s.useCallback)((()=>{const n="function"==typeof e?e():e,r=t(Object.assign(o(n),(a=document.location.hash)?a.substr(1).split("&").map((e=>{const[t,o]=e.split("=");return[decodeURIComponent(t),decodeURIComponent(o)]})).reduce(((e,[t,o])=>(e[t]=o,e)),{}):{}));var a;return history.pushState(void 0,document.title,c(o(r))),r}),[t,e,o]),[i,u]=(0,s.useState)(a),f=(0,s.useRef)();return f.current||(f.current=r()((function(e){history.pushState(void 0,document.title,c(o(e)))}),n)),f.current(i),(0,s.useEffect)((()=>{const e=()=>{u(a())};return window.addEventListener("hashchange",e),()=>{window.removeEventListener("hashchange",e)}}),[a]),[i,u]}}}]);