(self.webpackChunkworkshop=self.webpackChunkworkshop||[]).push([[388],{8881:(t,o,e)=>{"use strict";e.r(o),e.d(o,{quickhull:()=>d,default:()=>u});var n=e(2182),r=e(9392),a=e(7392),i=e(9526);const s="C:\\Users\\aval\\tsdev\\workshop\\src\\noises\\index.tsx",l=(a.$_("blue").gl(),(0,n.Nv)(512,(t=>n.V3.polar(1,2*(Math.random()-.5)*Math.PI)))),c=(t,o,e)=>{const r=0|t,a=r+1,i=0|o,s=i+1,c=t=>t*t*(3-2*t),d=(t,o,e,r)=>{const a=e-t,i=r-o;return(0,n.en)(l,59*t+o).dot(new n.V3(a,i,0))},u=d(r,i,t,o),f=d(a,i,t,o),v=(0,n.t7)(u,f,e?c(t-r):t-r),m=d(r,s,t,o),p=d(a,s,t,o),M=(0,n.t7)(m,p,e?c(t-r):t-r);return(0,n.t7)(v,M,e?c(o-i):o-i)};function d(t){let o=!0;const e=1024,i=1024,s=new Uint8Array(e*i),l=new r.xE(e,i,{format:t.RED,type:t.UNSIGNED_BYTE,internalFormat:t.R8}),d=()=>{let t=1/0,r=-1/0;for(let a=0;a<i;a++)for(let i=0;i<e;i++){const l=(0,n.uZ)(.8*(c(i/64,a/64,o)+.5),0,1),d=Math.random();s[a*e+i]=.2<l&&l<.3?0:254,r=Math.max(r,d),t=Math.min(t,d)}s[0]=0,console.log(s),l.setData(s),console.log("min,max",t,r)};d();const u=r.Kj.plane(),f=r.Kj.sphere(0).computeWireframeFromFlatTrianglesClosedMesh().compile(),v=function(t){const o=[],e=Math.sqrt(3)/2,r=Math.cos(Math.PI/3),a=2*Math.asin(1/Math.sqrt(3));for(let i=-0;i<2;i++)for(let s=-0;s<2;s++)for(let l=-0;l<1;l++){const c=i+(s%2==0?0:r);o.push(t.transform(n.M4.scale(1,.01,.01).translate(c,s*e,l*e)),t.transform(n.M4.scale(1,.01,.01).rotateZ(Math.PI/3).translate(c,s*e,l*e)),t.transform(n.M4.scale(1,.01,.01).rotateZ(Math.PI/3*2).translate(c,s*e,l*e)),t.transform(n.M4.scale(1,.01,.01).rotateZ(Math.PI/2).rotateX((Math.PI-a)/2).translate(c,s*e,l*e)),t.transform(n.M4.scale(1,.01,.01).rotateY(-Math.PI/3*2).rotateX(Math.PI/2-a).translate(c,s*e,l*e)),t.transform(n.M4.scale(1,.01,.01).rotateY(-Math.PI/3).rotateX(Math.PI/2-a).translate(c,s*e,l*e)))}const[i,...s]=o;return i.concat(...s)}(r.Kj.rotation([n.V3.Y,n.V3.XY],{anchor:n.V3.O,dir1:n.V3.X},2*Math.PI,3,!0));console.log(f);const m=r.ex.create("\n\t  uniform mat4 ts_ModelViewProjectionMatrix;\n\t  attribute vec4 ts_Vertex;\n\t  uniform float pointSize;\n\t  varying vec4 foo;\n\t  void main() {\n\t\tfoo = vec4(1.0, 1.0, 1.0, 1.0);\n\t\tgl_Position = ts_ModelViewProjectionMatrix * ts_Vertex;\n\t\tgl_PointSize = pointSize;\n\t  }\n\t","\n\t  precision highp float;\n\t  uniform vec4 color;\n\t  varying vec4 bar;\n\t  void main() {\n\t\tgl_FragColor = color;\n\t\tif (length(gl_PointCoord - vec2(0.5, 0.5)) > 0.5) {\n\t\t  discard;\n\t\t}\n\t  }\n\t"),p=r.ex.create("\n\t  uniform mat4 ts_ModelViewProjectionMatrix;\n\t  attribute vec4 ts_Vertex;\n\t  uniform float pointSize;\n\t  attribute vec3 ts_TexCoordUVQ;\n\t  attribute vec2 ts_TexCoord;\n\t  varying vec4 foo;\n\t  varying vec3 coordUVQ;\n\t  varying vec2 coord;\n\t  void main() {\n\t\tfoo = vec4(1.0, 1.0, 1.0, 1.0);\n\t\tgl_Position = ts_ModelViewProjectionMatrix * ts_Vertex;\n\t\tgl_PointSize = pointSize;\n\t\tcoordUVQ = ts_TexCoordUVQ;\n\t\tcoord = ts_TexCoord;\n\t  }\n\t","\n\t  precision highp float;\n\t  uniform sampler2D texture;\n\t  uniform vec4 color;\n\t  varying vec4 bar;\n\t  varying vec3 coordUVQ;\n\t  varying vec2 coord;\n\t  void main() {\n\t\tgl_FragColor = color;\n\t\tgl_FragColor = texture2D(texture, coordUVQ.xy / coordUVQ.z).rrra\n\t\t\t+ texture2D(texture, coord).rrra;\n\t\tif (length(gl_PointCoord - vec2(0.5, 0.5)) > 0.5) {\n\t\t  discard;\n\t\t}\n\t  }\n\t"),M={pos:(0,n.V)(.75,0,1),lookDir:(0,n.V)(0,0,-1)};(()=>{if(null!=localStorage.getItem("viewState")){const t=JSON.parse(localStorage.getItem("viewState"));M.pos=n.V3.fromArray(t.pos),M.lookDir=n.V3.fromArray(t.lookDir)}})(),t.clearColor(1,1,1,0),t.cullFace(t.BACK);const g=()=>{t.matrixMode(t.PROJECTION),t.loadIdentity(),t.perspective(70,t.canvas.width/t.canvas.height,.1,1e3),t.lookAt((0,n.V)(.75,0,1),(0,n.V)(.75,0,0),n.V3.Y),t.matrixMode(t.MODELVIEW)};g(),t.pointSize(10),t.enable(t.CULL_FACE),t.enable(t.DEPTH_TEST),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA);let h={};console.log(t.canvas),t.canvas.contentEditable="true",t.canvas.focus(),t.canvas.onkeydown=function(e){h[e.key]=!0,"o"===e.key&&(o=!o,d()),"2"===e.key&&g(),"1"===e.key&&(t.matrixMode(t.PROJECTION),t.loadIdentity(),t.perspective(70,t.canvas.width/t.canvas.height,.1,1e3),t.lookAt((0,n.V)(0,.5,2.2),n.V3.O,n.V3.Y),t.matrixMode(t.MODELVIEW))},t.canvas.onkeypress=function(t){new n.V3(0,0,0)},t.canvas.onkeyup=function(t){h[t.key]=!1};let x=n.V3.O,V=n.M4.IDENTITY;return t.canvas.onmousemove2=function(t){const o=(0,n.V)(t.pageX,t.pageY),e=x.to(o);1&t.buttons&&(V=V.rotateZ(.25*e.x*n.Co),V=V.rotateX(.25*e.y*n.Co)),x=o},t.canvas.onmousemove=function(t){const o=(0,n.V)(t.pageX,t.pageY),e=x.to(o);if(1&t.buttons){const t=n.M4.rotateY(.25*-e.x*n.Co).rotateX(.25*-e.y*n.Co);M.lookDir=t.transformVector(M.lookDir).unit()}x=o},t.animate((function(o,e){const r=new n.V3(+!!h.w-+!!h.s,+!!h.a-+!!h.d,+!!h.e-+!!h.q+ +!!h[" "]).times(.05);if(!r.likeO()){const t=M.lookDir;M.pos=M.pos.plus(n.M4.forSys(t,n.V3.Y.cross(t).unit()).transformVector(r)),localStorage.setItem("viewState",JSON.stringify({pos:M.pos.toArray(),lookDir:M.lookDir.toArray()}))}t.matrixMode(t.PROJECTION),t.loadIdentity(),t.perspective(70,t.canvas.width/t.canvas.height,.1,1e3),t.lookAt(M.pos,M.pos.plus(M.lookDir),n.V3.Y),t.matrixMode(t.MODELVIEW),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.loadIdentity(),t.pushMatrix(),t.translate(.25,-.5,0),m.uniforms({color:a.iv("red").gl(),pointSize:12}).draw(u,t.LINES),l.bind(0),p.uniforms({color:a.iv("red").gl(),pointSize:12,texture:0}).draw(u),t.popMatrix(),t.pushMatrix(),t.translate(-.75,0,0),t.scale(.5),t.rotate(-90,1,0,0),p.uniforms({color:a.iv("red").gl(),pointSize:12,texture:0}).draw(f),m.uniforms({color:a.iv("red").gl(),pointSize:12}).draw(f,t.LINES),t.popMatrix(),m.uniforms({color:a.iv("blue").gl()}).draw(v)}))}const u=()=>{const t=(0,i.useRef)(null);return(0,i.useEffect)((()=>{const o=r.ZG.create({canvas:t.current});o.fixCanvasRes(),o.addResizeListener(),d(o)}),[]),i.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%"},__self:void 0,__source:{fileName:s,lineNumber:430}},i.createElement("canvas",{ref:t,style:{flexGrow:1},tabIndex:0,__self:void 0,__source:{fileName:s,lineNumber:431}}))}}}]);